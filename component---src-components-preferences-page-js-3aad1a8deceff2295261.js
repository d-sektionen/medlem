(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{G7rm:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a("q1tI"),r=a.n(n),l=a("zGz4"),s=a("Rq/j"),i=a("Y7rJ"),c=a.n(i);const o=({text:e,onAccept:t,onDecline:a})=>{const n=Object(l.b)();return r.a.createElement("div",{className:c.a.confirmation},r.a.createElement("p",null,e),r.a.createElement(s.a,{onClick:()=>{a(),n()}},"Nej"),r.a.createElement(s.a,{onClick:()=>{t(),n()}},"Ja"))};function u(){const[e,t]=Object(l.a)(o);return[(t,a,n)=>{e("",{text:t,onAccept:a,onDecline:n})},t]}o.defaultProps={text:"Är du säker?",onAccept:()=>{},onDecline:()=>{}}},kRcL:function(e,t,a){e.exports={label:"form-module--label--1j4rO",inputWrapper:"form-module--inputWrapper--tEZjQ",required:"form-module--required--1ei65"}},noUn:function(e,t,a){"use strict";a("rGqo");var n=a("q1tI"),r=a.n(n),l=a("ZACD"),s=a("X0yR"),i=a("kRcL"),c=a.n(i);var o=({value:e,onChange:t,type:a,label:n,required:l,min_value:i,max_value:o,min_length:u,max_length:m})=>{const d=e=>{t(e.target.value)},p={datetime:r.a.createElement(s.a,{value:e,onChange:t}),date:r.a.createElement("input",{type:"date",value:e,onChange:d}),boolean:r.a.createElement("input",{type:"checkbox",checked:e,onChange:e=>{t(e.target.checked)}}),integer:r.a.createElement("input",{type:"number",value:e,onChange:d,max:o,min:i})},b=Object.prototype.hasOwnProperty.call(p,a)?p[a]:r.a.createElement("input",{value:e,onChange:d,maxLength:m,minLength:u});return r.a.createElement("label",{className:c.a.label},""+n,l&&r.a.createElement("span",{className:c.a.required},"*"),r.a.createElement("div",{className:c.a.inputWrapper},b))},u=a("Rq/j");const m=({endpoint:e,method:t,customFetcher:a,onSubmit:s,defaults:i})=>{const{0:c,1:m}=Object(n.useState)(),{0:d,1:p}=Object(n.useState)(i),{0:b,1:h}=Object(n.useState)({});return Object(n.useEffect)(()=>{Object(l.d)(e).then(e=>{const t=e.data.actions.POST,a=Object.keys(t).map(e=>Object.assign({key:e},t[e])).filter(e=>!e.read_only);m(a)}).catch(e=>{})},e),r.a.createElement("form",{onSubmit:n=>{n.preventDefault(),s(),a?a(d).catch(e=>{e.response&&h(e.response.data)}):Object(l.a)({endpoint:e,method:t,data:d})}},c&&c.map(e=>r.a.createElement(r.a.Fragment,{key:e.key},r.a.createElement(o,Object.assign({},e,{onChange:t=>{((e,t)=>{p(a=>Object.assign({},a,{[e]:t}))})(e.key,t)},value:d[e.key]})),Object.prototype.hasOwnProperty.call(b,e.key)&&r.a.createElement("div",null,b[e.key].join(", ")))),r.a.createElement(u.a,{type:"submit",onClick:()=>{}},"Submit"))};m.defaultProps={method:"POST",customFetcher:null,onSubmit:()=>{},defaults:{}};t.a=m},"sM+Y":function(e,t,a){e.exports={inputLabel:"preferences-module--inputLabel--37O6A",error:"preferences-module--error--2-qsf",success:"preferences-module--success--1uRT2",calendarSubNotice:"preferences-module--calendarSubNotice--DsQks"}},vwZb:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),r=a.n(n),l=a("8k0H"),s=a("ZACD"),i=a("sM+Y"),c=a.n(i),o=a("Rq/j");class u extends n.Component{constructor(e){super(e),e.user.profile||(e.user.profile={}),this.state={infomailSubscriber:e.user.profile.infomail_subscriber,liuCardId:e.user.profile.liu_card_id,firstName:e.user.first_name,lastName:e.user.last_name,errors:{}},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e,t,a=!1){a?this.setState({[e]:t.target.checked}):this.setState({[e]:t.target.value})}handleSubmit(e){const{setLoading:t,setUser:a}=this.props;this.setState({error:void 0,success:void 0,errors:{}}),t(!0),Object(s.g)("/account/profile/",{first_name:this.state.firstName,last_name:this.state.lastName,liu_card_id:this.state.liuCardId,infomail_subscriber:this.state.infomailSubscriber}).then(e=>{t(!1),e.status<300&&(this.setState({success:"Ändringarna har sparats."}),a(t=>Object.assign({},t,{first_name:e.data.firstName,last_name:e.data.lastName,profile:Object.assign({},t.profile,{liu_card_id:e.data.liu_card_id,infomail_subscriber:e.data.infomail_subscriber})})))}).catch(e=>{console.log(e),t(!1),e.response?400===e.response.status?this.setState({errors:e.response.data}):this.setState({error:"Något gick fel."}):this.setState({error:"Nätverksfel."})}),e.preventDefault()}render(){const{user:e}=this.props,{firstName:t,lastName:a,liuCardId:n,infomailSubscriber:l,errors:s,error:i,success:u}=this.state;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("h2",null,"Profil"),r.a.createElement("p",null,r.a.createElement("strong",null,e.membership?"Du är sektionsmedlem.":"Du saknar sektionsmedlemsskap.")),r.a.createElement("div",null,r.a.createElement("label",{className:c.a.inputLabel},"Förnamn:",r.a.createElement("input",{value:t,onChange:e=>this.handleChange("firstName",e)})),s.first_name&&r.a.createElement("div",{className:c.a.error},s.first_name)),r.a.createElement("div",null,r.a.createElement("label",{className:c.a.inputLabel},"Efternamn:",r.a.createElement("input",{value:a,onChange:e=>this.handleChange("lastName",e)})),s.last_name&&r.a.createElement("div",{className:c.a.error},s.last_name)),r.a.createElement("div",null,r.a.createElement("label",{className:c.a.inputLabel},"LiU-kortnummer:",r.a.createElement("input",{value:n,onChange:e=>this.handleChange("liuCardId",e)})),s.profile&&s.profile.liu_card_id&&r.a.createElement("div",{className:c.a.error},s.profile.liu_card_id)),r.a.createElement("div",null,r.a.createElement("label",{className:c.a.inputLabel},"Prenumerera på veckomailet:",r.a.createElement("input",{type:"checkbox",checked:l,onChange:e=>this.handleChange("infomailSubscriber",e,!0)})),s.profile&&s.profile.infomail_subscriber&&r.a.createElement("div",{className:c.a.error},s.profile.infomail_subscriber)),r.a.createElement("div",null,r.a.createElement(o.a,{type:"submit"},"Spara")),r.a.createElement("div",null,i&&r.a.createElement("div",{className:c.a.error},i),u&&r.a.createElement("div",{className:c.a.success},u)))}}var m=u,d=a("r90U"),p=a("zw+i"),b=(a("a1Th"),a("rGqo"),a("rE2o"),a("ioFf"),a("VtrM")),h=a("Tgqd"),f=a("QaCa"),E=a("G7rm"),g=a("noUn");var v=({create:e})=>r.a.createElement(g.a,{endpoint:"/account/calendar-subscriptions/",customFetcher:e,defaults:{include_bookings:!0,include_events_attending:!0,include_events_not_attending:!0}}),k=a("zGz4");var _=({url:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Denna webbadress kan importeras i ditt kalenderprogram. Länken kommer automatiskt hållas uppdaterad med nya händelser."),r.a.createElement("div",{className:c.a.calendarSubNotice},r.a.createElement("input",{value:e,readOnly:!0}),r.a.createElement(o.a,{onClick:()=>{navigator.clipboard.writeText(e)}},"Kopiera")));function y(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return C(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const j=e=>{const t=[];e.include_bookings&&t.push("bokningar"),e.include_events_attending&&t.push("anmälda evenemang"),e.include_events_not_attending&&t.push("oanmälda evenemang");const a=t.join(", ");return a.charAt(0).toUpperCase()+a.substring(1)};var O=()=>{const[e]=Object(k.a)(v),[t]=Object(k.a)(_),[a]=Object(E.a)(),n=Object(k.b)(),{data:l,mutate:i}=Object(b.b)("/account/calendar-subscriptions/");return r.a.createElement("div",null,r.a.createElement("h2",null,"Kalenderprenumerationer"),r.a.createElement(f.a,null,l&&l.map(e=>r.a.createElement(f.c,{title:j(e),key:e.id,buttons:[r.a.createElement(f.b,{iconComponent:h.h,text:"Visa länk",onClick:()=>{t("Prenumerationslänk",{url:e.url})},key:"view"}),r.a.createElement(f.b,{iconComponent:h.m,text:"Ta bort prenumeration",onClick:()=>{a("Är du säker på att du vill ta bort prenumerationen?",async()=>{await Object(s.b)("/account/calendar-subscriptions/"+e.id+"/"),i(l.filter(t=>t.id!==e.id))})},key:"delete"})]}))),r.a.createElement(o.a,{onClick:()=>{e("Ny prenumeration",{create:async e=>{const{data:t}=await Object(s.f)("/account/calendar-subscriptions/",e);i([].concat(y(l),[t])),n()}})}},"Ny prenumeration"))},N=a("INns");t.default=({pageContext:{title:e}})=>{const t=Object(n.useContext)(l.a)[1],{0:a,1:s}=Object(n.useContext)(l.b);return r.a.createElement(d.a,null,r.a.createElement(p.a,null,r.a.createElement(p.b,{fullWidth:!0},r.a.createElement(N.a,{title:e})),r.a.createElement(p.b,null,r.a.createElement(m,{user:a,setUser:s,setLoading:t})),r.a.createElement(p.b,null,r.a.createElement(O,null))))}}}]);
//# sourceMappingURL=component---src-components-preferences-page-js-3aad1a8deceff2295261.js.map