{"version":3,"sources":["webpack:///./src/components/ui/titleChooser.js","webpack:///./src/components/ui/list.js","webpack:///./src/components/vote/speakerPanel.js","webpack:///./src/components/vote/meetingInfoPanel.js","webpack:///./src/components/vote/voteForm.js","webpack:///./src/components/vote/votePanel.js","webpack:///./src/components/vote/page.js"],"names":["TitleChooser","title","choices","choice","setChoice","label","action","actionLabel","className","style","titleChooser","onChange","e","selectedValue","target","value","c","filter","i","id","map","key","onClick","List","children","list","ListItem","subtitle","buttons","listText","listButtons","ListButton","href","Icon","iconComponent","text","shown","listButton","type","defaultProps","SpeakerPanel","meeting","useSWR","speakers","data","mutate","user","useContext","UserContext","errorMessage","attending","enable_speaker_requests","a","post","meeting_id","newSpeaker","prioritized","s","pretty_name","prioQS","del","x","FiTrash2","MeetingInfoPanel","currentMeeting","revalidate","name","description","whiteSpace","open_attendance","VoteForm","vote","useState","checkedId","setCheckedId","successfullyVoted","setSuccessfullyVoted","placeVote","voteData","vote_id","alternative_id","votingDisabled","buttonText","alreadyVotedText","question","has_voted","alternatives","checked","disabled","VotePanel","votes","error","useEffect","length","VotePage","pageContext","setCurrentMeeting","meetings","find","m","fullWidth"],"mappings":"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","file":"component---src-components-vote-page-js-41136ba3c15b2378671c.js","sourcesContent":["import React from 'react'\n\nimport style from '../../scss/ui.module.scss'\nimport { Button } from './buttons'\n\nconst TitleChooser = ({\n  title,\n  choices,\n  choice,\n  setChoice,\n  label,\n  action,\n  actionLabel,\n}) => {\n  return (\n    <div className={style.titleChooser}>\n      <h1>{title}</h1>\n\n      {choices && (\n        <select\n          onChange={e => {\n            const selectedValue = e.target.value\n            const c =\n              selectedValue === ''\n                ? null\n                : choices.filter(i => `${i.id}` === selectedValue)[0]\n            setChoice(c)\n          }}\n          value={choice ? choice.id : ''}\n        >\n          <option value=\"\" />\n          {choices.map(c => (\n            <option value={c.id} key={c.id}>\n              {c[label]}\n            </option>\n          ))}\n        </select>\n      )}\n      {action && <Button onClick={action}>{actionLabel}</Button>}\n    </div>\n  )\n}\n\nexport default TitleChooser\n","import React from 'react'\n\nimport style from '../../scss/ui.module.scss'\n\nconst List = ({ children }) => <ul className={style.list}>{children}</ul>\n\nconst ListItem = ({ title, subtitle, buttons }) => (\n  <li>\n    <div className={style.listText}>\n      <h3>{title}</h3>\n      <p>{subtitle}</p>\n    </div>\n    <div className={style.listButtons}>{buttons}</div>\n  </li>\n)\n\nconst ListButton = ({ href, onClick, iconComponent: Icon, text, shown }) =>\n  shown ? (\n    <>\n      {href ? (\n        <a\n          className={style.listButton}\n          href={href}\n          onClick={onClick}\n          title={text}\n        >\n          <Icon />\n        </a>\n      ) : (\n        <button\n          className={style.listButton}\n          type=\"button\"\n          onClick={onClick}\n          title={text}\n        >\n          <Icon />\n        </button>\n      )}\n    </>\n  ) : (\n    <></>\n  )\n\nListButton.defaultProps = {\n  shown: true,\n}\n\nexport { List, ListItem, ListButton }\n","import React, { useState, useEffect, useContext } from 'react'\nimport useSWR from 'swr'\n\nimport { FiTrash2 } from 'react-icons/fi'\nimport { List, ListButton, ListItem } from '../ui/list'\nimport { Button, ButtonGroup } from '../ui/buttons'\nimport { UserContext } from '../layout/layout'\nimport { post, del } from '../request'\n\nconst SpeakerPanel = ({ meeting }) => {\n  const { data: speakers, mutate } = useSWR(\n    () => meeting && `/voting/speakers/?meeting_id=${meeting.id}`\n  )\n\n  const [user] = useContext(UserContext)\n\n  const errorMessage = meeting.attending\n    ? 'Talarlista är inaktiverad för mötet.'\n    : 'Du måste vara registrerad på mötet för att kunna skriva upp dig på talarlistan.'\n\n  return (\n    <div>\n      <h2>Talarlista</h2>\n      {meeting.attending && meeting.enable_speaker_requests ? (\n        <ButtonGroup>\n          <Button\n            onClick={async () => {\n              const { data: newSpeaker } = await post('/voting/speakers/', {\n                meeting_id: meeting.id,\n              })\n              mutate([...speakers, newSpeaker])\n            }}\n          >\n            Jag vill tala!\n          </Button>\n          <Button\n            onClick={async () => {\n              const { data: newSpeaker } = await post('/voting/speakers/', {\n                meeting_id: meeting.id,\n                prioritized: true,\n              })\n              mutate([...speakers, newSpeaker])\n            }}\n          >\n            Replik!\n          </Button>\n        </ButtonGroup>\n      ) : (\n        <p>{errorMessage}</p>\n      )}\n      <List>\n        {speakers &&\n          speakers.map(s => (\n            <ListItem\n              title={s.user.pretty_name}\n              subtitle={s.prioritized ? 'Replik' : null}\n              key={s.id}\n              buttons={[\n                <ListButton\n                  shown={user.id === s.user.id}\n                  onClick={async () => {\n                    const prioQS = s.prioritized ? '&prioritized' : ''\n                    await del(\n                      `/voting/speakers/?meeting_id=${meeting.id}${prioQS}`\n                    )\n                    mutate(speakers.filter(x => x.id !== s.id))\n                  }}\n                  iconComponent={FiTrash2}\n                  text=\"Lämna talarlista\"\n                  key=\"remove\"\n                />,\n              ]}\n            />\n          ))}\n      </List>\n    </div>\n  )\n}\n\nexport default SpeakerPanel\n","import React from 'react'\nimport { Button } from '../ui/buttons'\nimport { post, del } from '../request'\n\nconst MeetingInfoPanel = ({ currentMeeting, revalidate }) => (\n  <div>\n    <h2>Mötesinfo</h2>\n    <h3>{currentMeeting.name}</h3>\n    <p>\n      <strong>\n        {currentMeeting.attending\n          ? 'Du deltar på mötet.'\n          : 'Du är inte registrerad på mötet.'}\n      </strong>\n    </p>\n    {currentMeeting.description && (\n      <p style={{ whiteSpace: 'pre-line' }}>{currentMeeting.description}</p>\n    )}\n    {currentMeeting.open_attendance && (\n      <p>\n        {currentMeeting.attending ? (\n          <Button\n            onClick={async () => {\n              await del(`/voting/attend/?meeting_id=${currentMeeting.id}`)\n              revalidate()\n            }}\n          >\n            Lämna röstlängden\n          </Button>\n        ) : (\n          <Button\n            onClick={async () => {\n              await post('/voting/attend/', { meeting_id: currentMeeting.id })\n              revalidate()\n            }}\n          >\n            Gå med i röstlängden\n          </Button>\n        )}\n      </p>\n    )}\n  </div>\n)\n\nexport default MeetingInfoPanel\n","import React, { Component, useState } from 'react'\nimport { post } from '../request'\n\nconst VoteForm = ({ vote }) => {\n  const [checkedId, setCheckedId] = useState(-1)\n  const [successfullyVoted, setSuccessfullyVoted] = useState(false)\n\n  const placeVote = async () => {\n    const voteData = {\n      vote_id: vote.id,\n      alternative_id: checkedId,\n    }\n\n    await post('/voting/made_votes/', voteData)\n    setSuccessfullyVoted(true)\n  }\n  const votingDisabled = checkedId === -1\n  const buttonText = votingDisabled ? 'Välj ett alternativ' : 'Rösta'\n  const alreadyVotedText = successfullyVoted\n    ? 'Tack för din röst!'\n    : 'Du har röstat i omröstningen.'\n\n  return (\n    <div>\n      <strong>{vote.question}</strong>\n      {vote.has_voted || successfullyVoted ? (\n        <p>{alreadyVotedText}</p>\n      ) : (\n        <>\n          <ul>\n            {vote.alternatives.map(({ text, id }) => (\n              <li key={id}>\n                <label>\n                  <input\n                    type=\"radio\"\n                    checked={checkedId === id}\n                    onChange={() => setCheckedId(id)}\n                  />\n                  {` ${text}`}\n                </label>\n              </li>\n            ))}\n          </ul>\n          <button type=\"button\" disabled={votingDisabled} onClick={placeVote}>\n            {buttonText}\n          </button>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default VoteForm\n","import React, { useContext, useState, useEffect } from 'react'\nimport useSWR from 'swr'\nimport VoteForm from './voteForm'\n\n// import style from '../../scss/vote.module.scss'\n\nconst VotePanel = ({ meeting }) => {\n  const { data: votes, error, revalidate } = useSWR(\n    () => `/voting/votes/?meeting_id=${meeting.id}`\n  )\n\n  useEffect(\n    () => {\n      revalidate()\n    },\n    [meeting]\n  )\n  return (\n    <div>\n      <h2>Rösta</h2>\n      {votes && (\n        <>\n          {votes.length === 0 && <p>Det finns ingen aktiv omröstning</p>}\n          {votes.map(vote => (\n            <VoteForm key={vote.id} vote={vote} />\n          ))}\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default VotePanel\n","import React, { useContext, useState, useEffect } from 'react'\nimport useSWR from 'swr'\n\nimport BigPixels from '../layout/bigPixels'\nimport { GridContainer, GridItem } from '../ui/grid'\nimport TitleChooser from '../ui/titleChooser'\nimport SpeakerPanel from './speakerPanel'\nimport MeetingInfoPanel from './meetingInfoPanel'\nimport VotePanel from './votePanel'\n\nconst VotePage = ({ pageContext: { title } }) => {\n  const [currentMeeting, setCurrentMeeting] = useState(null)\n  const { data: meetings, revalidate } = useSWR('/voting/meetings/')\n\n  // sync currentMeeting with updated meetings\n  useEffect(\n    () => {\n      if (currentMeeting)\n        setCurrentMeeting(meetings.find(m => m.id === currentMeeting.id))\n    },\n    [meetings]\n  )\n\n  return (\n    <BigPixels>\n      <GridContainer>\n        <GridItem fullWidth>\n          <TitleChooser\n            title={title}\n            choice={currentMeeting}\n            setChoice={setCurrentMeeting}\n            choices={meetings}\n            label=\"name\"\n          />\n        </GridItem>\n        {currentMeeting && (\n          <>\n            <GridItem>\n              <MeetingInfoPanel\n                currentMeeting={currentMeeting}\n                revalidate={revalidate}\n              />\n            </GridItem>\n            <GridItem>\n              <VotePanel meeting={currentMeeting} />\n            </GridItem>\n            {/* {currentMeeting.enable_speaker_requests && ( */}\n            <GridItem>\n              <SpeakerPanel meeting={currentMeeting} />\n            </GridItem>\n            {/* )} */}\n          </>\n        )}\n      </GridContainer>\n    </BigPixels>\n  )\n}\nexport default VotePage\n"],"sourceRoot":""}