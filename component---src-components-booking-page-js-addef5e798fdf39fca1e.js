(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{232:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(32),o=n(45),c=n(43),l=n(223),u=n.n(l),s=n(44),m=n(31),d=n(255),f=n.n(d);n(259);var b=({value:e,onChange:t})=>r.a.createElement("div",null,r.a.createElement("input",{type:"date",value:e.format("YYYY-MM-DD"),onChange:n=>{const a=n.target.value,r=parseInt(a.slice(0,4),10),i=parseInt(a.slice(5,7),10),o=parseInt(a.slice(8,10),10);if(o&&i&&r){const n=f()(e).set({year:r,month:i-1,date:o});t(n)}}}),r.a.createElement("input",{type:"time",value:e.format("HH:mm"),onChange:n=>{const a=n.target.value,r=parseInt(a.slice(0,2),10),i=parseInt(a.slice(3,5),10);if(!Number.isNaN(r)&&!Number.isNaN(i)){const n=f()(e).set({hour:r,minute:i});t(n)}}})),k=n(18);function g(e){void 0===e&&(e=0);var t=new Date;return t.setHours(t.getHours()+2+e+Math.round(t.getMinutes()/60)),t.setMinutes(0),t}var p=function(e){var t=e.booking,n=e.item,i=e.createBooking,o=e.updateBooking,c=void 0===t,l=Object(a.useContext)(k.b)[0],d=Object(m.b)(),p=Object(a.useState)(t?t.description:""),v=p[0],E=p[1],h=Object(a.useState)(t?t.start:g()),y=h[0],j=h[1],O=Object(a.useState)(t?t.end:g(2)),w=O[0],C=O[1],x=Object(a.useState)({}),N=x[0],B=x[1],P=t?t.user.pretty_name:l.pretty_name;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Bokning av "+n.name+" för "+P+"."),r.a.createElement("div",{className:u.a.editForm},r.a.createElement("h3",null,"Startdatum"),r.a.createElement("div",null,N.start),r.a.createElement(b,{value:f()(y),onChange:j}),r.a.createElement("h3",null,"Slutdatum"),r.a.createElement("div",null,N.end),r.a.createElement(b,{value:f()(w),onChange:C}),r.a.createElement("h3",null,"Ändamål"),r.a.createElement("div",null,N.description),r.a.createElement("textarea",{className:u.a.description,value:v,onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",null,N.non_field_errors),r.a.createElement(s.a,{onClick:function(){(c?i({item_id:n.id,description:v,start:y,end:w}):o(t.id,{item_id:t.item.id,description:v,start:y,end:w})).then(function(){d()}).catch(function(e){B(e.response.data)})}},"Save"))};n(24);f.a.locale("sv");var v=function(e){return e.toLocaleDateString("sv-SE",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},E=function(e){var t=e.booking;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Bokning av ",t.item.name," för ",t.user.pretty_name,"."),r.a.createElement("p",null,f()(t.start).to(t.end,!0),", ",v(t.start)+" - "+v(t.end)),r.a.createElement("p",null,t.description))},h=n(229),y=n.n(h),j=function(e,t){for(var n=function(e,t){var n=f()(e).startOf("day"),a=f.a.duration(e.diff(n)),r=f.a.duration(t.diff(e));return a.add(r).days()}(e,t),a=[[e,t]],r=1;r<=n;r+=1)a[r]=[f()(a[r-1][0]).add(1,"d").startOf("day"),a[r-1][1]],a[r-1][1]=f()(a[r-1][0]).endOf("day");return a},O=function(e){return 50*e.weekday()+50},w=function(e){var t=f()(e).startOf("day");return 10*f.a.duration(e.diff(t)).asHours()},C=function(e){var t=e.itemId,n=Object(c.f)({endpoint:"/booking/bookings/?item="+t})[0],i=Object(m.a)(E)[0],o=Object(a.useState)(f()()),l=o[0],u=o[1],s=f()(),d=l.year()===s.year()?"":", "+l.year();return r.a.createElement("div",null,r.a.createElement("div",{className:y.a.controls},r.a.createElement("div",null,"Vecka "+l.week()+d),r.a.createElement("div",null,r.a.createElement("button",{type:"button",onClick:function(){return u(function(e){return f()(e.subtract(1,"w"))})}},"-"),r.a.createElement("button",{type:"button",onClick:function(){return u(f()())}},"nu"),r.a.createElement("button",{type:"button",onClick:function(){return u(function(e){return f()(e.add(1,"w"))})}},"+"))),r.a.createElement("svg",{version:"1.1",viewBox:"0 0 400 240",xmlns:"http://www.w3.org/2000/svg"},n&&n.filter(function(e){var t=e.start,n=e.end,a=f()(t).week(),r=f()(n).week();return a===l.week()||r===l.week()}).map(function(e){var t=f()(e.start),n=f()(e.end),a=j(t,n);return r.a.createElement("g",{className:y.a.booking,key:e.id},a.filter(function(e){var t=e[0];return f()(t).week()===l.week()&&f()(t).year()===l.year()}).map(function(t){var n,a,o=t[0],c=t[1];return r.a.createElement("rect",{key:e.id+", "+o.day(),x:O(o),y:w(o),width:"50",height:(n=o,a=c,10*f.a.duration(a.diff(n)).asHours()),stroke:"white",onClick:function(){return i("Bokningsinformation",{booking:Object.assign({},e,{start:new Date(e.start),end:new Date(e.end)})})}})}))}),r.a.createElement("g",{className:y.a.timeIndicators},[6,12,18].map(function(e){return r.a.createElement("g",{key:e},r.a.createElement("text",{x:"0",y:10*e-2},("0"+e).slice(-2),":00"),r.a.createElement("line",{x1:"0",y1:10*e,x2:"400",y2:10*e}))})),s.week()===l.week()&&s.year()===l.year()&&r.a.createElement("line",{x1:O(s),x2:O(s)+50,y1:w(s),y2:w(s),className:y.a.nowMarker}),r.a.createElement("line",{x1:"50",y1:"0",x2:"50",y2:"240",stroke:"lightgray"})))},x=function(e){var t=e.item,n=e.setItem,a=e.createBooking,i=Object(c.f)({endpoint:"/booking/items/"})[0],o=Object(m.a)(p)[0];return r.a.createElement(r.a.Fragment,null,r.a.createElement("select",{className:u.a.items,onChange:function(e){var t=e.target.value;n(""===t?null:i.filter(function(e){return""+e.id===t})[0])},value:t?t.id:""},r.a.createElement("option",{value:""},"Alla"),i&&i.map(function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})),t?r.a.createElement("div",null,r.a.createElement("h2",null,"Beskrivning"),r.a.createElement("p",{className:u.a.itemDescription},t.description),r.a.createElement("h2",null,"Tillgänglighet"),r.a.createElement(C,{itemId:t.id}),r.a.createElement("h2",null,"Boka"),t.terms&&r.a.createElement("p",null,"Genom att boka "+t.name+" godkänner du ",r.a.createElement("a",{href:t.terms,target:"_blank",rel:"noopener noreferrer"},"bokningsavtalet"),"."),r.a.createElement(s.a,{onClick:function(){return o("Boka "+t.name,{item:t,createBooking:a})}},"Boka "+t.name)):r.a.createElement("p",null,"Välj ett objekt för att kunna boka."))},N=n(256),B=n(10),P=n(2),S=n.n(P),D=n(42),_=n.n(D),I=function(e){var t=e.text,n=e.onAccept,a=e.onDecline,i=Object(m.b)();return r.a.createElement("div",{className:_.a.confirmation},r.a.createElement("p",null,t),r.a.createElement(s.a,{onClick:function(){a(),i()}},"Nej"),r.a.createElement(s.a,{onClick:function(){n(),i()}},"Ja"))};I.propTypes={text:S.a.string,onAccept:S.a.func,onDecline:S.a.func},I.defaultProps={text:"Är du säker?",onAccept:function(){},onDecline:function(){}};var T=n(9),M=n(23),F=n.n(M);const H=({text:e,value:t,click:n,defaultChecked:a})=>r.a.createElement("div",{className:F.a.checkbox},r.a.createElement("label",{htmlFor:t},r.a.createElement("input",{id:t,type:"checkbox",onClick:e=>n(e),value:t,defaultChecked:a}),e));H.propTypes={text:S.a.string,value:S.a.string.isRequired,defaultChecked:S.a.bool,click:S.a.func},H.defaultProps={text:"",defaultChecked:!1,click:()=>null};const A=({off:e,on:t,click:n,defaultToggled:i})=>{const[o,c]=Object(a.useState)(i),l=T.b.div({on:{background:"blue"},off:{background:"lightgray"},transition:{duration:4e3}}),u=T.b.div({on:{x:"90%"},off:{x:"0%"},transition:{duration:1e3}});return r.a.createElement("div",{className:[F.a.switch,o?F.a.on:F.a.off].join(" ")},r.a.createElement(l,{className:F.a.slider,pose:o?"on":"off",onClick:()=>{c(!o),n(!o)}},r.a.createElement(u,{className:F.a.blob,pose:o?"on":"off"})),r.a.createElement("p",null,o?t:e))};A.propTypes={off:S.a.string.isRequired,on:S.a.string.isRequired,click:S.a.func,defaultToggled:S.a.bool},A.defaultProps={click:()=>null,defaultToggled:!1},f.a.locale("sv");var R=({item:e,bookings:t,listBookings:n,updateBooking:i,destroyBooking:o})=>{const[c]=Object(a.useContext)(k.b),[l,u]=Object(a.useState)(!1),[s]=Object(m.a)(p),[d]=Object(m.a)(E),[b]=function(){var e=Object(m.a)(I),t=e[0];return[function(e,n,a){t("",{text:e,onAccept:n,onDecline:a})},e[1]]}();return Object(a.useEffect)(()=>{n({item:e?e.id:void 0,future:!0,user:l?"me":void 0})},[e,l]),r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{text:" Visa endast mina bokningar.",value:"Only Mine",click:e=>u(e.target.checked)}),r.a.createElement(N.a,null,t&&t.map(e=>Object.assign({},e,{start:new Date(e.start),end:new Date(e.end)})).sort((e,t)=>e.start-t.start).map(t=>r.a.createElement(N.c,{title:t.user.pretty_name,subtitle:`${e?"":`${t.item.name}, `}${f()(t.start).calendar()}`,buttons:[r.a.createElement(N.b,{shown:t.user.username===c.username||c.privileges.booking_admin,iconComponent:B.k,text:"Ta bort bokning",onClick:()=>{b("Är du säker på att du vill ta bort bokningen?",()=>o(t.id))},key:"delete"}),r.a.createElement(N.b,{shown:t.user.username===c.username||c.privileges.booking_admin,iconComponent:B.c,text:"Redigera",onClick:()=>{s(`Redigera bokning av ${t.item.name}`,{booking:t,item:t.item,updateBooking:i})},key:"edit"}),r.a.createElement(N.b,{iconComponent:B.f,text:"Mer information",onClick:()=>{d("Bokningsinformation",{booking:t})},key:"info"})],key:t.id}))))},Y=n(246),$=function(){var e=Object(a.useState)(null),t=e[0],n=e[1],c=Object(Y.a)({endpoint:"/booking/bookings/"}),l=c[0],u=l.list,s=l.create,m=l.destroy,d=l.update,f=c[1];return r.a.createElement(o.a,null,r.a.createElement(i.a,null,r.a.createElement(i.b,null,r.a.createElement(x,{setItem:n,item:t,createBooking:s})),r.a.createElement(i.b,null,r.a.createElement(R,{item:t,bookings:f,listBookings:u,updateBooking:d,destroyBooking:m}))))};t.default=function(){return r.a.createElement($,null)}},246:function(e,t,n){"use strict";n(55),n(72),n(24);var a=n(1),r=n(18),i=n(43),o=function(){var e;return(e=Object.prototype.hasOwnProperty).call.apply(e,arguments)},c=function(e,t){var n=Object.assign({},e);return["endpoint","url"].forEach(function(e){o(n,e)&&(n=Object.assign({},n,{[e]:""+n[e]+t+"/"}))}),n};t.a=function(e){var t=Object(a.useContext)(r.a)[1],n=Object(a.useState)(null),l=n[0],u=n[1],s=Object(a.useState)(null),m=s[0],d=s[1];return[{list:function(n){return void 0===n&&(n={}),t(!0),Object(i.a)(Object.assign({},e,{params:Object.assign({},o(e,"params")?e.params:{},n),method:"get"})).then(function(e){return d(null),u(e.data),t(!1),Promise.resolve(e)}).catch(function(e){return d(e),t(!1),Promise.reject(e)})},retrieve:function(n,a){return void 0===a&&(a={}),t(!0),Object(i.a)(Object.assign({},c(e,n),{params:Object.assign({},o(e,"params")?e.params:{},a),method:"get"})).then(function(e){return d(null),u(function(t){return[].concat(t.filter(function(e){return e.id!==n}),[e.data])}),t(!1),Promise.resolve(e)}).catch(function(e){return d(e),t(!1),Promise.reject(e)})},update:function(n,a){return void 0===a&&(a={}),t(!0),Object(i.a)(Object.assign({},c(e,n),{data:a,method:"put"})).then(function(e){return d(null),u(function(t){return[].concat(t.filter(function(e){return e.id!==n}),[e.data])}),t(!1),Promise.resolve(e)}).catch(function(e){return d(e),t(!1),Promise.reject(e)})},create:function(n){return void 0===n&&(n={}),t(!0),Object(i.a)(Object.assign({},e,{data:n,method:"post"})).then(function(e){return d(null),u(function(t){return[].concat(t,[e.data])}),t(!1),Promise.resolve(e)}).catch(function(e){return d(e),t(!1),Promise.reject(e)})},destroy:function(n,a){return void 0===a&&(a={}),t(!0),Object(i.a)(Object.assign({},c(e,n),{data:a,method:"delete"})).then(function(e){return d(null),u(function(e){return e.filter(function(e){return e.id!==n})}),t(!1),Promise.resolve(e)}).catch(function(e){return d(e),t(!1),Promise.reject(e)})}},l,m]}},256:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return u});var a=n(1),r=n.n(a),i=n(23),o=n.n(i),c=function(e){var t=e.children;return r.a.createElement("ul",{className:o.a.list},t)},l=function(e){var t=e.title,n=e.subtitle,a=e.buttons;return r.a.createElement("li",null,r.a.createElement("div",{className:o.a.listText},r.a.createElement("h3",null,t),r.a.createElement("p",null,n)),r.a.createElement("div",{className:o.a.listButtons},a))},u=function(e){var t=e.onClick,n=e.iconComponent,a=e.text;return e.shown?r.a.createElement("button",{type:"button",onClick:t,title:a},r.a.createElement(n,null)):r.a.createElement(r.a.Fragment,null)};u.defaultProps={shown:!0}}}]);
//# sourceMappingURL=component---src-components-booking-page-js-addef5e798fdf39fca1e.js.map