(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+1s0":function(e,t,a){"use strict";a.r(t);var n=a("t8Zj"),l=a("q1tI"),r=a.n(l),c=a("VtrM"),i=a("Rq/j"),m=a("ZACD");var u=({currentMeeting:e,updatePatch:t})=>r.a.createElement("div",null,r.a.createElement("h2",null,"Mötesinfo"),r.a.createElement("h3",null,e.name),e.description&&r.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.description),r.a.createElement("h3",null,"Detaljer"),r.a.createElement("ul",null,r.a.createElement("li",null,e.enable_speaker_requests?"Talarlista aktiverad":"Talarlista inaktiverad"),r.a.createElement("li",null,e.open_attendance?"Öppen incheckning":"Stängd incheckning"),r.a.createElement("li",null,"Mötesdata rensas: "+e.clear_data)),r.a.createElement(i.b,null,r.a.createElement(i.a,{onClick:()=>t({enable_speaker_requests:!e.enable_speaker_requests})},e.enable_speaker_requests?"Inaktivera talarlista":"Aktivera talarlista"),r.a.createElement(i.a,{onClick:()=>t({open_attendance:!e.open_attendance})},e.open_attendance?"Stäng självincheckning":"Öppna självincheckning"))),s=a("ReHE"),o=a("Tgqd"),d=a("zGz4"),b=a("G7rm");let v=0;const E=(e={})=>(v+=1,{text:"",...e,key:v});var p=({currentMeeting:e,create:t,updateData:a,update:c})=>{const{0:i,1:m}=Object(l.useState)(a?a.question:""),{0:u,1:s}=Object(l.useState)(a?a.alternatives.map(e=>E(e)):[E(),E()]),{0:o,1:d}=Object(l.useState)(!a||a.open),{0:b,1:v}=Object(l.useState)(!!a&&a.max_number_of_selectable_alternatives>1),{0:p,1:g}=Object(l.useState)(!!a&&a.min_number_of_selectable_alternatives===a.max_number_of_selectable_alternatives),{0:_,1:h}=Object(l.useState)(a?a.min_number_of_selectable_alternatives:1),{0:k,1:j}=Object(l.useState)(a?a.max_number_of_selectable_alternatives:1);return r.a.createElement("div",null,r.a.createElement("label",null,"Fråga",r.a.createElement("input",{value:i,onChange:e=>{m(e.target.value)}})),r.a.createElement("hr",null),r.a.createElement("ul",null,u.map((e,t)=>r.a.createElement("li",{key:e.key},r.a.createElement("input",{value:e.text,onChange:e=>{const a=e.target.value;s(e=>[].concat(Object(n.a)(e.slice(0,t)),[{...e[t],text:a}],Object(n.a)(e.slice(t+1))))}}),r.a.createElement("button",{type:"button",onClick:()=>{s(e=>[].concat(Object(n.a)(e.slice(0,t)),Object(n.a)(e.slice(t+1))))}},"X")))),r.a.createElement("button",{type:"button",onClick:()=>{s(e=>[].concat(Object(n.a)(e),[E()]))}},"Lägg till alternativ"),r.a.createElement("hr",null),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:o,onChange:()=>d(e=>!e)}),"Nuvarande frågan"),r.a.createElement("hr",null),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:b,onChange:()=>{v(e=>!e),h(1),j(1)}}),"Flervalsfråga"),r.a.createElement("hr",null),b&&r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:p,onChange:()=>{g(e=>!e),h(1),j(1)}}),"Ett exakt antal valbara alternativ"),r.a.createElement("hr",null)),b&&p&&r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Antal alternativ som",r.a.createElement("br",null),"ska väljas av deltagarna:",r.a.createElement("br",null)),r.a.createElement("select",{name:"min-svar",id:"min-svar",onChange:e=>{h(Number(e.target.value)),j(Number(e.target.value))},defaultValue:k},u.map((e,t)=>r.a.createElement("option",{key:t+1,value:t+1},t+1))),r.a.createElement("br",null)),b&&!p&&r.a.createElement(r.a.Fragment,null,r.a.createElement("label",null,"Minsta antal alternativ som",r.a.createElement("br",null),"kan väljas av deltagarna:",r.a.createElement("br",null)),r.a.createElement("select",{name:"min-svar",id:"min-svar",onChange:e=>h(Number(e.target.value)),defaultValue:_},u.map((e,t)=>r.a.createElement("option",{key:t+1,value:t+1},t+1))),r.a.createElement("br",null),r.a.createElement("label",null,"Högsta antal:",r.a.createElement("br",null)),r.a.createElement("select",{name:"max-svar",id:"max-svar",onChange:e=>j(Number(e.target.value)),defaultValue:k},u.map((e,t)=>r.a.createElement("option",{key:t+1,value:t+1},t+1)))),r.a.createElement("br",null),b&&!p&&_>k&&r.a.createElement("p",null,"Du måste välja ett",r.a.createElement("br",null),"'högsta antal' större än",r.a.createElement("br",null),"eller lika med",r.a.createElement("br",null),"'minsta antal'"),r.a.createElement("button",{type:"button",disabled:b&&_>k,onClick:()=>{a?c(a.id,{question:i,open:o,alternatives:u,meeting:e.id,min_number_of_selectable_alternatives:b?_:1,max_number_of_selectable_alternatives:b?k:1}):t({question:i,open:o,alternatives:u,meeting:e.id,min_number_of_selectable_alternatives:b?_:1,max_number_of_selectable_alternatives:b?k:1})}},a?"Uppdatera omröstning":"Skapa ny omröstning"))},g=a("T4TL"),_=a("QaCa");var h=({currentMeeting:e})=>{const{data:t,mutate:a}=Object(c.b)("/voting/admin-votes/?event_id="+e.id),u=async e=>{const{data:l}=await Object(m.f)("/voting/admin-votes/",e);return a([].concat(Object(n.a)(t),[l])),l},s=async(e,l)=>{const{data:r}=await Object(m.g)("/voting/admin-votes/"+e+"/",l);return a([].concat(Object(n.a)(t.filter(t=>t.id!==e)),[r])),r},[v]=Object(d.a)(p),[E]=Object(d.a)(g.a),h=Object(d.b)(),[k]=Object(b.a)();return Object(l.useEffect)(h,[t]),r.a.createElement("div",null,r.a.createElement("h2",null,"Omröstningar"),r.a.createElement(i.a,{onClick:()=>v("Ny omröstning",{currentMeeting:e,create:u})},"Ny omröstning"),r.a.createElement(_.a,null,t&&t.filter(t=>t.meeting===e.id).map(t=>r.a.createElement(_.c,{title:t.question,subtitle:t.open?"Active":void 0,key:t.id,buttons:[r.a.createElement(_.b,{onClick:()=>k("Vill du se resultatet?",()=>{(async t=>{await h(),E('Resultat av "'+t.question+'"',{currentMeeting:e,voteId:t.id})})(t)},h),iconComponent:o.a,text:"Resultat",key:"results"}),r.a.createElement(_.b,{onClick:()=>v('Uppdatera "'+t.question+'"',{currentMeeting:e,update:s,updateData:t}),iconComponent:o.d,text:"Uppdatera omröstning",key:"update"})]}))))};const k=e=>e.filter(e=>e.has_voting_rights);var j=({currentMeeting:e})=>{const{0:t,1:a}=Object(l.useState)(""),{data:u,mutate:s}=Object(c.b)(()=>"/voting/attendants/?meeting_id="+e.id,{refreshInterval:4e3});return null===u?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",null,r.a.createElement("h2",null,"Deltagare"),r.a.createElement("form",{onSubmit:async l=>{l.preventDefault(),a("");const{data:r}=await Object(m.f)("/voting/attendants/",{user_username:t,meeting_id:e.id,has_voting_rights:!0});s([].concat(Object(n.a)(u),[r]))}},r.a.createElement("input",{value:t,onChange:e=>a(e.target.value)})),r.a.createElement("div",null,r.a.createElement(i.b,null,r.a.createElement("p",null,"Röstlängd: "+(u?k(u).length:0)),r.a.createElement(i.a,{onClick:async()=>{await Object(m.b)("/voting/attendants/clear/?meeting_id="+e.id),s([])}},"Återställ deltagarlista"))),r.a.createElement(_.a,null,u&&k(u).map(t=>r.a.createElement(_.c,{title:t.user.pretty_name,key:t.id,buttons:[r.a.createElement(_.b,{onClick:async()=>{await Object(m.b)("/voting/attendants/"+t.id,{meeting_id:e.id}),s(u.filter(e=>e.id!==t.id))},iconComponent:o.l,text:"Ta bort deltagare",key:"remove"})]}))))},f=a("zw+i");a("8k0H");var O=({meeting:e})=>{const{data:t,mutate:a}=Object(c.b)(()=>e&&"/voting/speakers/?meeting_id="+e.id,{refreshInterval:4e3});return r.a.createElement("div",null,r.a.createElement("h2",null,"Talarlista"),r.a.createElement(_.a,null,t&&t.map(e=>r.a.createElement(_.c,{title:e.user.pretty_name,subtitle:e.prioritized?"Replik":null,key:e.id,buttons:[r.a.createElement(_.b,{onClick:async()=>{await Object(m.b)("/voting/speakers/"+e.id),a(t.filter(t=>t.id!==e.id))},iconComponent:o.l,text:"Ta bort från talarlista",key:"remove"})]}))))},y=a("INns"),C=a("noUn");var x=({create:e})=>r.a.createElement(C.a,{endpoint:"/voting/admin-meetings/",customFetcher:e}),S=a("r90U");const q=e=>e.filter(e=>!e.has_voting_rights);var w=({currentMeeting:e})=>{const{0:t,1:a}=Object(l.useState)(""),{data:u,mutate:s}=Object(c.b)(()=>"/voting/attendants/?meeting_id="+e.id,{refreshInterval:4e3});return null===u?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",null,r.a.createElement("h2",null,"Gäster/adjungerade"),r.a.createElement("form",{onSubmit:async l=>{l.preventDefault(),a("");const{data:r}=await Object(m.f)("/voting/attendants/",{user_username:t,meeting_id:e.id,has_voting_rights:!1});s([].concat(Object(n.a)(u),[r]))}},r.a.createElement("input",{value:t,onChange:e=>a(e.target.value)})),r.a.createElement("div",null,r.a.createElement(i.b,null,r.a.createElement("p",null,"Antal gäster/adjungerade: "+(u?q(u).length:0)))),r.a.createElement(_.a,null,u&&q(u).map(t=>r.a.createElement(_.c,{title:t.user.pretty_name,key:t.id,buttons:[r.a.createElement(_.b,{onClick:async()=>{await Object(m.b)("/voting/attendants/"+t.id,{meeting_id:e.id}),s(u.filter(e=>e.id!==t.id))},iconComponent:o.l,text:"Ta bort gäst",key:"remove"})]}))))};t.default=({pageContext:{title:e}})=>{const{0:t,1:a}=Object(l.useState)(null),{data:i,mutate:o}=Object(c.b)("/voting/admin-meetings/"),[b]=Object(d.a)(x),v=Object(d.b)(),E=i?Object(n.a)(i).reverse():null;return Object(l.useEffect)(()=>{t&&a(E.find(e=>e.id===t.id))},[E]),r.a.createElement(S.a,null,r.a.createElement(f.a,null,r.a.createElement(f.b,{fullWidth:!0},r.a.createElement(y.a,{title:e,choice:t,setChoice:a,choices:E,label:"name",action:()=>{b("Nytt möte",{create:async e=>{await(async e=>{const{data:t}=await Object(m.f)("/voting/admin-meetings/",e);o([].concat(Object(n.a)(i),[t]))})(e),v()}})},actionLabel:"Nytt möte",noChoicesLabel:"Det finns inga möten just nu."})),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(f.b,null,r.a.createElement(u,{currentMeeting:t,updatePatch:async e=>{const{data:a}=await Object(m.e)("/voting/admin-meetings/"+t.id+"/",e);o([].concat(Object(n.a)(i.filter(e=>e.id!==t.id)),[a]))}})),r.a.createElement(f.b,null,r.a.createElement(h,{currentMeeting:t})),r.a.createElement(f.b,null,r.a.createElement(s.a,{event:t})),r.a.createElement(f.b,null,r.a.createElement(j,{currentMeeting:t})),r.a.createElement(f.b,null,r.a.createElement(w,{currentMeeting:t})),r.a.createElement(f.b,null,r.a.createElement(O,{meeting:t})))))}},G7rm:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a("q1tI"),l=a.n(n),r=a("zGz4"),c=a("Rq/j"),i=a("Y7rJ"),m=a.n(i);const u=({text:e,onAccept:t,onDecline:a})=>{const n=Object(r.b)();return l.a.createElement("div",{className:m.a.confirmation},l.a.createElement("p",null,e),l.a.createElement(c.a,{onClick:()=>{a(),n()}},"Nej"),l.a.createElement(c.a,{onClick:()=>{t(),n()}},"Ja"))};function s(){const[e,t]=Object(r.a)(u);return[(t,a,n)=>{e("",{text:t,onAccept:a,onDecline:n})},t]}u.defaultProps={text:"Är du säker?",onAccept:()=>{},onDecline:()=>{}}},ReHE:function(e,t,a){"use strict";var n=a("t8Zj"),l=a("q1tI"),r=a.n(l),c=a("Tgqd"),i=a("QaCa"),m=a("VtrM"),u=a("ZACD");t.a=({event:e})=>{const{0:t,1:a}=Object(l.useState)(""),{data:s,mutate:o}=Object(m.b)("/checkin/doorkeepers/?event_id="+e.id);return r.a.createElement("div",null,r.a.createElement("h2",null,"Dörrvakter"),r.a.createElement("form",{onSubmit:l=>{l.preventDefault(),a(""),(async e=>{const{data:t}=await Object(u.f)("/checkin/doorkeepers/",e);o([].concat(Object(n.a)(s),[t]))})({user_username:t,event_id:e.id})}},r.a.createElement("input",{value:t,onChange:e=>a(e.target.value)})),r.a.createElement(i.a,null,s&&s.map(e=>r.a.createElement(i.c,{title:e.user.pretty_name,key:e.id,buttons:[r.a.createElement(i.b,{onClick:()=>(async e=>{await Object(u.b)("/checkin/doorkeepers/"+e+"/"),o(s.filter(t=>t.id!==e))})(e.id),iconComponent:c.l,text:"Ta bort dörrvakt",key:"remove"})]}))))}},T4TL:function(e,t,a){"use strict";var n=a("q1tI"),l=a.n(n),r=a("VtrM");t.a=({currentMeeting:e,voteId:t})=>{const{data:a}=Object(r.b)(()=>t&&"/voting/admin-votes/"+t+"/"),n=(a?a.alternatives.map(e=>e.num_votes):[]).reduce((e,t)=>e+t,0),c=a?a.attendants_voted:"",{data:i}=Object(r.b)("/voting/admin-votes/?event_id="+e.id),m=i.filter(e=>e.id===t)[0],u=m.max_number_of_selectable_alternatives,s=m.min_number_of_selectable_alternatives;return l.a.createElement("div",null,s<u&&l.a.createElement("p",null,s,"-",u," alternativ väljs av deltagarna"),s===u&&l.a.createElement("p",null,u," alternativ väljs av deltagarna"),l.a.createElement("ul",null,a&&a.alternatives.map(e=>l.a.createElement("li",{key:e.text},e.text+": "+e.num_votes,n?" ("+(e.num_votes?Math.round(1e3*e.num_votes/n)/10:0)+"%)":""))),l.a.createElement("p",null,"Summa av alla röster: ",n),l.a.createElement("p",null,"Antal personer som röstat: ",c))}},kRcL:function(e,t,a){e.exports={label:"form-module--label--1j4rO",inputWrapper:"form-module--inputWrapper--tEZjQ",required:"form-module--required--1ei65"}},noUn:function(e,t,a){"use strict";var n=a("q1tI"),l=a.n(n),r=a("ZACD"),c=a("X0yR"),i=a("kRcL"),m=a.n(i);var u=({value:e,onChange:t,type:a,label:n,required:r,min_value:i,max_value:u,min_length:s,max_length:o})=>{const d=e=>{t(e.target.value)},b={datetime:l.a.createElement(c.a,{value:e,onChange:t}),date:l.a.createElement("input",{type:"date",value:e,onChange:d}),boolean:l.a.createElement("input",{type:"checkbox",checked:e,onChange:e=>{t(e.target.checked)}}),integer:l.a.createElement("input",{type:"number",value:e,onChange:d,max:u,min:i})},v=Object.prototype.hasOwnProperty.call(b,a)?b[a]:l.a.createElement("input",{value:e,onChange:d,maxLength:o,minLength:s});return l.a.createElement("label",{className:m.a.label},""+n,r&&l.a.createElement("span",{className:m.a.required},"*"),l.a.createElement("div",{className:m.a.inputWrapper},v))},s=a("Rq/j");const o=({endpoint:e,method:t,customFetcher:a,onSubmit:c,defaults:i})=>{const{0:m,1:o}=Object(n.useState)(),{0:d,1:b}=Object(n.useState)(i),{0:v,1:E}=Object(n.useState)({});return Object(n.useEffect)(()=>{Object(r.d)(e).then(e=>{const t=e.data.actions.POST,a=Object.keys(t).map(e=>({key:e,...t[e]})).filter(e=>!e.read_only);o(a)}).catch(e=>{})},e),l.a.createElement("form",{onSubmit:n=>{n.preventDefault(),c(),a?a(d).catch(e=>{e.response&&E(e.response.data)}):Object(r.a)({endpoint:e,method:t,data:d})}},m&&m.map(e=>l.a.createElement(l.a.Fragment,{key:e.key},l.a.createElement(u,Object.assign({},e,{onChange:t=>{((e,t)=>{b(a=>({...a,[e]:t}))})(e.key,t)},value:d[e.key]})),Object.prototype.hasOwnProperty.call(v,e.key)&&l.a.createElement("div",null,v[e.key].join(", ")))),l.a.createElement(s.a,{type:"submit",onClick:()=>{}},"Submit"))};o.defaultProps={method:"POST",customFetcher:null,onSubmit:()=>{},defaults:{}};t.a=o}}]);
//# sourceMappingURL=component---src-components-voting-admin-page-js-dcd644f339715966ae45.js.map