{"version":3,"file":"component---src-components-preferences-page-js-eaeea4ff3198b6b1ef63.js","mappings":"+OACWA,EAAQ,4BACRC,EAAe,mCC4D1B,MAzDkBC,IAUX,IAVY,MACjBC,EAAK,SACLC,EAAQ,KACRC,EAAI,MACJC,EAAK,SACLC,EAAQ,UACRC,EAAS,UACTC,EAAS,WACTC,EAAU,WACVC,GACDT,EACC,MAAMU,EAASC,IACbT,EAASS,EAAEC,OAAOX,MAAM,EAGpBY,EAAM,CACVC,SAAUC,EAAAA,cAACC,EAAAA,EAAc,CAACf,MAAOA,EAAOC,SAAUA,IAClDe,KAAMF,EAAAA,cAAA,SAAOZ,KAAK,OAAOF,MAAOA,EAAOC,SAAUQ,IACjDQ,QACEH,EAAAA,cAAA,SACEZ,KAAK,WACLgB,QAASlB,EACTC,SAAUS,IACRT,EAASS,EAAEC,OAAOO,QAAQ,IAIhCC,QACEL,EAAAA,cAAA,SACEZ,KAAK,SACLF,MAAOA,EACPC,SAAUQ,EACVW,IAAKd,EACLe,IAAKhB,KAKLiB,EAAYC,OAAOC,UAAUC,eAAeC,KAAKd,EAAKV,GAC1DU,EAAIV,GAEJY,EAAAA,cAAA,SACEd,MAAOA,EACPC,SAAUQ,EACVkB,UAAWnB,EACXoB,UAAWrB,IAIf,OACEO,EAAAA,cAAA,SAAOe,UAAWhC,GAAM,GAClBM,EACHC,GAAYU,EAAAA,cAAA,QAAMe,UAAWC,EAAAA,UAAU,KACxChB,EAAAA,cAAA,OAAKe,UAAW/B,GAAewB,GACzB,E,UCrDZ,MAAMS,EAAWhC,IAA8D,IAA7D,SAAEiC,EAAQ,OAAEC,EAAM,cAAEC,EAAa,SAAEC,EAAQ,SAAEC,GAAUrC,EACvE,MAAM,EAACsC,EAAO,EAACC,IAAaC,EAAAA,EAAAA,aACtB,EAACC,EAAO,EAACC,IAAaF,EAAAA,EAAAA,UAASH,IAC/B,EAACM,EAAO,EAACC,IAAaJ,EAAAA,EAAAA,UAAS,CAAC,GA4BtC,OAlBAK,EAAAA,EAAAA,YAAU,MAERC,EAAAA,EAAAA,IAAQb,GACLc,MAAKC,IACJ,MAAMC,EAAMD,EAAIE,KAAKC,QAAQC,KAOvBC,EAJa7B,OAAO8B,KAAKL,GAAKpC,KAAI0C,IAAG,CACzCA,SACGN,EAAIM,OAEmBC,QAAOC,IAAMA,EAAEC,YAE3CnB,EAAUc,EAAS,IAEpBM,OAAMC,OAAU,GAClB3B,GAGDlB,EAAAA,cAAA,QACEqB,SAAUzB,IACRA,EAAEkD,iBACFzB,IACID,EACFA,EAAcM,GAAQkB,OAAMC,IACtBA,EAAIE,UACNlB,EAAUgB,EAAIE,SAASZ,KACzB,KAGFa,EAAAA,EAAAA,IAAQ,CAAE9B,WAAUC,SAAQgB,KAAMT,GACpC,GAGDH,GACCA,EAAOzB,KAAImD,GACTjD,EAAAA,cAACA,EAAAA,SAAc,CAACwC,IAAKS,EAAMT,KACzBxC,EAAAA,cAACkD,EAASzC,OAAA0C,OAAA,GACJF,EAAK,CACT9D,SAAUiE,IA/CLC,EAACJ,EAAO/D,KACvByC,GAAU2B,IAAG,IAAUA,EAAK,CAACL,GAAQ/D,KAAS,EA+ClCmE,CAASJ,EAAMT,IAAKY,EAAS,EAE/BlE,MAAOwC,EAAOuB,EAAMT,QAErB/B,OAAOC,UAAUC,eAAeC,KAAKgB,EAAQqB,EAAMT,MAClDxC,EAAAA,cAAA,WAAM4B,EAAOqB,EAAMT,KAAKe,KAAK,UAIrCvD,EAAAA,cAACwD,EAAAA,GAAM,CAACpE,KAAK,SAASqE,QAASA,QAAU,UAGpC,EAIXxC,EAASyC,aAAe,CACtBvC,OAAQ,OACRC,cAAe,KACfC,SAAUA,OACVC,SAAU,CAAC,GAWb,O,mGClFA,MAAMqC,EAAe1E,IAAoC,IAAnC,KAAE2E,EAAI,SAAEC,EAAQ,UAAEC,GAAW7E,EACjD,MAAM8E,GAAQC,EAAAA,EAAAA,KACd,OACEhE,EAAAA,cAAA,OAAKe,UAAWkD,EAAAA,IACdjE,EAAAA,cAAA,SAAI4D,GACJ5D,EAAAA,cAACwD,EAAAA,GAAM,CACLC,QAASA,KACPK,IACAC,GAAO,GAEV,OAGD/D,EAAAA,cAACwD,EAAAA,GAAM,CACLC,QAASA,KACPI,IACAE,GAAO,GAEV,MAGG,EAgBK,SAASG,IACtB,MAAOC,EAAWC,IAAUC,EAAAA,EAAAA,GAASV,GAMrC,MAAO,CAJMW,CAACV,EAAMC,EAAUC,KAC5BK,EAAU,GAAI,CAAEP,OAAMC,WAAUC,aAAY,EAGhCM,EAChB,CAdAT,EAAaD,aAAe,CAC1BE,KAAM,eACNC,SAAUA,OACVC,UAAWA,O,0HCzCFS,EAAQ,mCAGRC,EAAa,wC,UCoKxB,MAjKiB,SAAAC,GACf,SAAAC,EAAYC,GAAQ,IAADC,EAc+B,OAbhDA,EAAAH,EAAA7D,KAAA,KAAM+D,IAAM,KAEPA,EAAME,KAAKC,UAASH,EAAME,KAAKC,QAAU,CAAC,GAE/CF,EAAKG,MAAQ,CACXC,mBAAoBL,EAAME,KAAKC,QAAQG,oBACvCC,UAAWP,EAAME,KAAKC,QAAQK,YAC9BC,UAAWT,EAAME,KAAKQ,WACtBC,SAAUX,EAAME,KAAKU,UACrB3D,OAAQ,CAAC,GAGXgD,EAAKY,aAAeZ,EAAKY,aAAaC,MAAIC,EAAAA,EAAAA,GAAAd,IAC1CA,EAAKe,aAAef,EAAKe,aAAaF,MAAIC,EAAAA,EAAAA,GAAAd,IAAMA,CAClD,EAhBegB,EAAAA,EAAAA,GAAAlB,EAAAD,GAgBd,IAAAoB,EAAAnB,EAAAhE,UA8IA,OA9IAmF,EAEDL,aAAA,SAAavC,EAAO6C,EAAOC,QAAQ,IAARA,IAAAA,GAAW,GAChCA,EAAUC,KAAKC,SAAS,CAAE,CAAChD,GAAQ6C,EAAMjG,OAAOO,UAC/C4F,KAAKC,SAAS,CAAE,CAAChD,GAAQ6C,EAAMjG,OAAOX,OAC7C,EAAC2G,EAEDF,aAAA,SAAaG,GACX,MAAM,WAAEI,EAAU,QAAEC,GAAYH,KAAKrB,MAGrCqB,KAAKC,SAAS,CAAEG,WAAOC,EAAWC,aAASD,EAAWzE,OAAQ,CAAC,IAE/DsE,GAAW,IACXK,EAAAA,EAAAA,IAAI,oBAAqB,CACvBlB,WAAYW,KAAKjB,MAAMK,UACvBG,UAAWS,KAAKjB,MAAMO,SACtBH,YAAaa,KAAKjB,MAAMG,UACxBD,oBAAqBe,KAAKjB,MAAMC,qBAE/BhD,MAAKC,IACJiE,GAAW,GACPjE,EAAIuE,OAAS,MACfR,KAAKC,SAAS,CAAEK,QAAS,6BAEzBH,GAAQM,IAAI,IACPA,EACHpB,WAAYpD,EAAIE,KAAKiD,UACrBG,UAAWtD,EAAIE,KAAKmD,SACpBR,QAAS,IACJ2B,EAAK3B,QACRK,YAAalD,EAAIE,KAAKgD,YACtBF,oBAAqBhD,EAAIE,KAAK8C,yBAGpC,IAEDrC,OAAMC,IACL6D,QAAQC,IAAI9D,GACZqD,GAAW,GACNrD,EAAIE,SACwB,MAAxBF,EAAIE,SAASyD,QACpBR,KAAKY,iBAAiB/D,EAAIE,UAFTiD,KAAKC,SAAS,CAAEG,MAAO,gBAG1C,IAEJN,EAAMhD,gBACR,EAEA+C,EAKAe,iBAAA,SAAiB7D,GAAW,IAAD8D,EACzB,OAAiB,QAAjBA,EAAI9D,EAASZ,YAAI,IAAA0E,GAAbA,EAAe1B,YACV,CACLvD,OAAQ,CACNkD,QAAS,CAAEK,YAAa,uCAKvB,CAAEiB,MAAO,kBAClB,EAACP,EAEDiB,OAAA,WACE,MAAM,KAAEjC,GAASmB,KAAKrB,OAChB,UACJS,EAAS,SACTE,EAAQ,UACRJ,EAAS,mBACTF,EAAkB,OAClBpD,EAAM,MACNwE,EAAK,QACLE,GACEN,KAAKjB,MACT,OACE/E,EAAAA,cAAA,QAAMqB,SAAU2E,KAAKL,cACnB3F,EAAAA,cAAA,UAAI,UACJA,EAAAA,cAAA,SACEA,EAAAA,cAAA,cACG6E,EAAKkC,WAAU,wBAEZ,mCAGR/G,EAAAA,cAAA,WACEA,EAAAA,cAAA,SAAOe,UAAWyD,GAAY,WAE5BxE,EAAAA,cAAA,SACEd,MAAOkG,EACPjG,SAAUS,GAAKoG,KAAKR,aAAa,YAAa5F,MAGjDgC,EAAOyD,YACNrF,EAAAA,cAAA,OAAKe,UAAWwD,GAAQ3C,EAAOyD,aAGnCrF,EAAAA,cAAA,WACEA,EAAAA,cAAA,SAAOe,UAAWyD,GAAY,aAE5BxE,EAAAA,cAAA,SACEd,MAAOoG,EACPnG,SAAUS,GAAKoG,KAAKR,aAAa,WAAY5F,MAGhDgC,EAAO2D,WAAavF,EAAAA,cAAA,OAAKe,UAAWwD,GAAQ3C,EAAO2D,YAEtDvF,EAAAA,cAAA,WACEA,EAAAA,cAAA,SAAOe,UAAWyD,GAAY,kBAE5BxE,EAAAA,cAAA,SACEd,MAAOgG,EACP/F,SAAUS,GAAKoG,KAAKR,aAAa,YAAa5F,MAGjDgC,EAAOkD,SAAWlD,EAAOkD,QAAQK,aAChCnF,EAAAA,cAAA,OAAKe,UAAWwD,GAAQ3C,EAAOkD,QAAQK,cAG3CnF,EAAAA,cAAA,WACEA,EAAAA,cAAA,SAAOe,UAAWyD,GAAY,8BAE5BxE,EAAAA,cAAA,SACEZ,KAAK,WACLgB,QAAS4E,EACT7F,SAAUS,GAAKoG,KAAKR,aAAa,qBAAsB5F,GAAG,MAG7DgC,EAAOkD,SAAWlD,EAAOkD,QAAQG,qBAChCjF,EAAAA,cAAA,OAAKe,UAAWwD,GAAQ3C,EAAOkD,QAAQG,sBAG3CjF,EAAAA,cAAA,WACEA,EAAAA,cAACwD,EAAAA,GAAM,CAACpE,KAAK,UAAS,UAExBY,EAAAA,cAAA,WACGoG,GAASpG,EAAAA,cAAA,OAAKe,UAAWwD,GAAQ6B,GACjCE,GAAWtG,EAAAA,cAAA,OAAKe,UD/JN,sCC+J2BuF,IAI9C,EAAC5B,CAAA,CA9Jc,CAASsC,EAAAA,W,+ECQ1B,MAZgC/H,IAAA,IAAC,OAAEgI,GAAQhI,EAAA,OACzCe,EAAAA,cAACiB,EAAAA,EAAQ,CACPC,SAAS,mCACTE,cAAe6F,EACf3F,SAAU,CACR4F,kBAAkB,EAClBC,0BAA0B,EAC1BC,8BAA8B,IAEhC,E,UCaJ,MApBqBnI,IAAA,IAAC,IAAEoI,GAAKpI,EAAA,OAC3Be,EAAAA,cAAAA,EAAAA,SAAA,KACEA,EAAAA,cAAA,SAAG,0HAIHA,EAAAA,cAAA,OAAKe,UHRsB,gDGSzBf,EAAAA,cAAA,SAAOd,MAAOmI,EAAKC,UAAQ,IAC3BtH,EAAAA,cAACwD,EAAAA,GAAM,CACLC,QAASA,KAEP8D,UAAUC,UAAUC,UAAUJ,EAAI,GAErC,YAIF,ECXL,MAAMK,EAAWC,IACf,MAAMC,EAAQ,GACVD,EAAIT,kBAAkBU,EAAMC,KAAK,aACjCF,EAAIR,0BAA0BS,EAAMC,KAAK,qBACzCF,EAAIP,8BAA8BQ,EAAMC,KAAK,sBAEjD,MAAMC,EAAWF,EAAMrE,KAAK,MAC5B,OAAOuE,EAASC,OAAO,GAAGC,cAAgBF,EAASG,UAAU,EAAE,EAoEjE,MAjE8BC,KAC5B,MAAOC,IAAmB9D,EAAAA,EAAAA,GAAS+D,IAC5BC,IAAiBhE,EAAAA,EAAAA,GAASiE,IAC1BC,IAAoBrE,EAAAA,EAAAA,KACrBsE,GAAaxE,EAAAA,EAAAA,MACX7B,KAAMsG,EAAI,OAAEC,IAAWC,EAAAA,EAAAA,IAAO,oCAEtC,OACE3I,EAAAA,cAAA,WACEA,EAAAA,cAAA,UAAI,2BACJA,EAAAA,cAAC4I,EAAAA,GAAI,KACFH,GACCA,EAAK3I,KAAI6H,GACP3H,EAAAA,cAAC6I,EAAAA,GAAQ,CACPC,MAAOpB,EAASC,GAChBnF,IAAKmF,EAAIoB,GACTC,QAAS,CACPhJ,EAAAA,cAACiJ,EAAAA,GAAU,CACTC,cAAeC,EAAAA,IACfvF,KAAK,YACLH,QAASA,KACP4E,EAAc,qBAAsB,CAClChB,IAAKM,EAAIN,KACT,EAEJ7E,IAAI,SAENxC,EAAAA,cAACiJ,EAAAA,GAAU,CACTC,cAAeE,EAAAA,IACfxF,KAAK,wBACLH,QAASA,KACP8E,EACE,uDACAc,gBACQC,EAAAA,EAAAA,IAAI,mCAAmC3B,EAAIoB,GAAE,KACnDL,EAAOD,EAAKhG,QAAO8G,GAAKA,EAAER,KAAOpB,EAAIoB,KAAI,GAE5C,EAEHvG,IAAI,iBAMhBxC,EAAAA,cAACwD,EAAAA,GAAM,CACLC,QAASA,KACP0E,EAAgB,mBAAoB,CAClClB,OAAQoC,UACN,MAAQlH,KAAMqH,SAAiBC,EAAAA,EAAAA,IAC7B,mCACAtH,GAEFuG,EAAO,GAADgB,QAAAC,EAAAA,EAAAA,GAAKlB,GAAI,CAAEe,KACjBhB,GAAY,GAEd,GAEL,oBAGG,E,UCtDV,MApBwBvJ,IAAiC,IAA9B2K,aAAa,MAAEd,IAAS7J,EACjD,MAAMiH,GAAa2D,EAAAA,EAAAA,YAAWC,EAAAA,IAAgB,IACxC,EAACjF,EAAK,EAACsB,IAAW0D,EAAAA,EAAAA,YAAWE,EAAAA,IACnC,OACE/J,EAAAA,cAACgK,EAAAA,EAAS,KACRhK,EAAAA,cAACiK,EAAAA,EAAa,KACZjK,EAAAA,cAACkK,EAAAA,EAAQ,CAACC,WAAS,GACjBnK,EAAAA,cAACoK,EAAAA,EAAY,CAACtB,MAAOA,KAEvB9I,EAAAA,cAACkK,EAAAA,EAAQ,KACPlK,EAAAA,cAAC0E,EAAW,CAACG,KAAMA,EAAMsB,QAASA,EAASD,WAAYA,KAEzDlG,EAAAA,cAACkK,EAAAA,EAAQ,KACPlK,EAAAA,cAACkI,EAAqB,QAGhB,C","sources":["webpack://medlem/./src/scss/form.module.scss","webpack://medlem/./src/components/form/input.js","webpack://medlem/./src/components/form/form.js","webpack://medlem/./src/components/modal/useConfirmModal.js","webpack://medlem/./src/scss/preferences.module.scss","webpack://medlem/./src/components/preferences/preferences.js","webpack://medlem/./src/components/preferences/addCalendarSubscription.js","webpack://medlem/./src/components/preferences/calendarLink.js","webpack://medlem/./src/components/preferences/calendarSubscriptions.js","webpack://medlem/./src/components/preferences/page.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport var Label = \"form-module--Label--ab587\";\nexport var inputWrapper = \"form-module--inputWrapper--1111e\";\nexport var required = \"form-module--required--7063a\";","import React, { useState, useEffect } from 'react'\nimport DateTimePicker from './dateTimePicker'\n\nimport { Label, Required, inputWrapper } from '../../scss/form.module.scss'\n\nconst AutoInput = ({\n  value,\n  onChange,\n  type,\n  label,\n  required,\n  min_value,\n  max_value,\n  min_length,\n  max_length,\n}) => {\n  const change = e => {\n    onChange(e.target.value)\n  }\n\n  const map = {\n    datetime: <DateTimePicker value={value} onChange={onChange} />,\n    date: <input type=\"date\" value={value} onChange={change} />,\n    boolean: (\n      <input\n        type=\"checkbox\"\n        checked={value}\n        onChange={e => {\n          onChange(e.target.checked)\n        }}\n      />\n    ),\n    integer: (\n      <input\n        type=\"number\"\n        value={value}\n        onChange={change}\n        max={max_value}\n        min={min_value}\n      />\n    ),\n  }\n\n  const component = Object.prototype.hasOwnProperty.call(map, type) ? (\n    map[type]\n  ) : (\n    <input\n      value={value}\n      onChange={change}\n      maxLength={max_length}\n      minLength={min_length}\n    />\n  )\n\n  return (\n    <label className={Label}>\n      {`${label}`}\n      {required && <span className={Required}>*</span>}\n      <div className={inputWrapper}>{component}</div>\n    </label>\n  )\n}\nexport default AutoInput\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport request, { options } from '../request'\nimport AutoInput from './input'\nimport { Button } from '../ui/buttons'\n\nconst AutoForm = ({ endpoint, method, customFetcher, onSubmit, defaults }) => {\n  const [fields, setFields] = useState()\n  const [values, setValues] = useState(defaults)\n  const [errors, setErrors] = useState({})\n\n  const setValue = (field, value) => {\n    setValues(old => ({ ...old, [field]: value }))\n  }\n\n  const setError = (field, error) => {\n    setErrors(old => ({ ...old, [field]: error }))\n  }\n\n  useEffect(() => {\n    // request endpoint info from server\n    options(endpoint)\n      .then(res => {\n        const raw = res.data.actions.POST\n\n        // object to array\n        const arrayified = Object.keys(raw).map(key => ({\n          key,\n          ...raw[key],\n        }))\n        const editable = arrayified.filter(f => !f.read_only)\n\n        setFields(editable)\n      })\n      .catch(err => {})\n  }, endpoint)\n\n  return (\n    <form\n      onSubmit={e => {\n        e.preventDefault()\n        onSubmit()\n        if (customFetcher) {\n          customFetcher(values).catch(err => {\n            if (err.response) {\n              setErrors(err.response.data)\n            }\n          })\n        } else {\n          request({ endpoint, method, data: values })\n        }\n      }}\n    >\n      {fields &&\n        fields.map(field => (\n          <React.Fragment key={field.key}>\n            <AutoInput\n              {...field}\n              onChange={newValue => {\n                setValue(field.key, newValue)\n              }}\n              value={values[field.key]}\n            />\n            {Object.prototype.hasOwnProperty.call(errors, field.key) && (\n              <div>{errors[field.key].join(', ')}</div>\n            )}\n          </React.Fragment>\n        ))}\n      <Button type=\"submit\" onClick={() => {}}>\n        Submit\n      </Button>\n    </form>\n  )\n}\n\nAutoForm.defaultProps = {\n  method: 'POST',\n  customFetcher: null,\n  onSubmit: () => {},\n  defaults: {},\n}\n\nAutoForm.propTypes = {\n  method: PropTypes.string,\n  endpoint: PropTypes.string.isRequired,\n  customFetcher: PropTypes.func,\n  onSubmit: PropTypes.func,\n  defaults: PropTypes.object,\n}\n\nexport default AutoForm\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport useModal, { useCloseModal } from './useModal'\nimport { Button } from '../ui/buttons'\n\nimport { confirmation } from '../../scss/modal.module.scss'\n\nconst Confirmation = ({ text, onAccept, onDecline }) => {\n  const close = useCloseModal()\n  return (\n    <div className={confirmation}>\n      <p>{text}</p>\n      <Button\n        onClick={() => {\n          onDecline()\n          close()\n        }}\n      >\n        Nej\n      </Button>\n      <Button\n        onClick={() => {\n          onAccept()\n          close()\n        }}\n      >\n        Ja\n      </Button>\n    </div>\n  )\n}\n\nConfirmation.propTypes = {\n  text: PropTypes.string,\n  onAccept: PropTypes.func,\n  onDecline: PropTypes.func,\n}\n\nConfirmation.defaultProps = {\n  text: 'Är du säker?',\n  onAccept: () => {},\n  onDecline: () => {},\n}\n\nexport default function useConfirmModal() {\n  const [openModal, isOpen] = useModal(Confirmation)\n\n  const open = (text, onAccept, onDecline) => {\n    openModal('', { text, onAccept, onDecline })\n  }\n\n  return [open, isOpen]\n}\n","// extracted by mini-css-extract-plugin\nexport var Error = \"preferences-module--Error--64b4f\";\nexport var Success = \"preferences-module--Success--2a5c9\";\nexport var calendarSubNotice = \"preferences-module--calendarSubNotice--f06ca\";\nexport var inputLabel = \"preferences-module--inputLabel--8938d\";","import React, { Component } from 'react'\n\nimport { put, patch } from '../request'\n\nimport { inputLabel, Error, Success } from '../../scss/preferences.module.scss'\nimport { Button } from '../ui/buttons'\n\nclass Preferences extends Component {\n  constructor(props) {\n    super(props)\n\n    if (!props.user.profile) props.user.profile = {}\n\n    this.state = {\n      infomailSubscriber: props.user.profile.infomail_subscriber,\n      liuCardId: props.user.profile.liu_card_id,\n      firstName: props.user.first_name,\n      lastName: props.user.last_name,\n      errors: {},\n    }\n\n    this.handleChange = this.handleChange.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  handleChange(field, event, checkbox = false) {\n    if (checkbox) this.setState({ [field]: event.target.checked })\n    else this.setState({ [field]: event.target.value })\n  }\n\n  handleSubmit(event) {\n    const { setLoading, setUser } = this.props\n\n    // reset errors\n    this.setState({ error: undefined, success: undefined, errors: {} })\n\n    setLoading(true)\n    put('/account/profile/', {\n      first_name: this.state.firstName,\n      last_name: this.state.lastName,\n      liu_card_id: this.state.liuCardId,\n      infomail_subscriber: this.state.infomailSubscriber,\n    })\n      .then(res => {\n        setLoading(false)\n        if (res.status < 300) {\n          this.setState({ success: 'Ändringarna har sparats.' })\n\n          setUser(prev => ({\n            ...prev,\n            first_name: res.data.firstName,\n            last_name: res.data.lastName,\n            profile: {\n              ...prev.profile,\n              liu_card_id: res.data.liu_card_id,\n              infomail_subscriber: res.data.infomail_subscriber,\n            },\n          }))\n        }\n      })\n      .catch(err => {\n        console.log(err)\n        setLoading(false)\n        if (!err.response) this.setState({ error: 'Nätverksfel.' })\n        else if (err.response.status === 400) {\n          this.getFormErrorText(err.response)\n        }\n      })\n    event.preventDefault()\n  }\n\n  /**\n   * Get error text to pass to setState.\n   * @param response - The response from the request.\n   * @returns Object - containing the error text.\n   */\n  getFormErrorText(response) {\n    if (response.data?.liu_card_id) {\n      return {\n        errors: {\n          profile: { liu_card_id: 'Det angivna LiU IDt är för långt.' },\n        },\n      }\n    }\n\n    return { error: 'Något gick fel.' }\n  }\n\n  render() {\n    const { user } = this.props\n    const {\n      firstName,\n      lastName,\n      liuCardId,\n      infomailSubscriber,\n      errors,\n      error,\n      success,\n    } = this.state\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <h2>Profil</h2>\n        <p>\n          <strong>\n            {user.membership\n              ? `Du är sektionsmedlem.`\n              : 'Du saknar sektionsmedlemsskap.'}\n          </strong>\n        </p>\n        <div>\n          <label className={inputLabel}>\n            Förnamn:\n            <input\n              value={firstName}\n              onChange={e => this.handleChange('firstName', e)}\n            />\n          </label>\n          {errors.first_name && (\n            <div className={Error}>{errors.first_name}</div>\n          )}\n        </div>\n        <div>\n          <label className={inputLabel}>\n            Efternamn:\n            <input\n              value={lastName}\n              onChange={e => this.handleChange('lastName', e)}\n            />\n          </label>\n          {errors.last_name && <div className={Error}>{errors.last_name}</div>}\n        </div>\n        <div>\n          <label className={inputLabel}>\n            LiU-kortnummer:\n            <input\n              value={liuCardId}\n              onChange={e => this.handleChange('liuCardId', e)}\n            />\n          </label>\n          {errors.profile && errors.profile.liu_card_id && (\n            <div className={Error}>{errors.profile.liu_card_id}</div>\n          )}\n        </div>\n        <div>\n          <label className={inputLabel}>\n            Prenumerera på veckomailet:\n            <input\n              type=\"checkbox\"\n              checked={infomailSubscriber}\n              onChange={e => this.handleChange('infomailSubscriber', e, true)}\n            />\n          </label>\n          {errors.profile && errors.profile.infomail_subscriber && (\n            <div className={Error}>{errors.profile.infomail_subscriber}</div>\n          )}\n        </div>\n        <div>\n          <Button type=\"submit\">Spara</Button>\n        </div>\n        <div>\n          {error && <div className={Error}>{error}</div>}\n          {success && <div className={Success}>{success}</div>}\n        </div>\n      </form>\n    )\n  }\n}\n\nexport default Preferences\n","import React from 'react'\nimport AutoForm from '../form/form'\n\nconst AddCalendarSubscription = ({ create }) => (\n  <AutoForm\n    endpoint=\"/account/calendar-subscriptions/\"\n    customFetcher={create}\n    defaults={{\n      include_bookings: true,\n      include_events_attending: true,\n      include_events_not_attending: true,\n    }}\n  />\n)\n\nexport default AddCalendarSubscription\n","import React from 'react'\nimport { Button } from '../ui/buttons'\n\nimport { calendarSubNotice } from '../../scss/preferences.module.scss'\n\nconst CalendarLink = ({ url }) => (\n  <>\n    <p>\n      Denna webbadress kan importeras i ditt kalenderprogram. Länken kommer\n      automatiskt hållas uppdaterad med nya händelser.\n    </p>\n    <div className={calendarSubNotice}>\n      <input value={url} readOnly />\n      <Button\n        onClick={() => {\n          // TODO: Error handling???\n          navigator.clipboard.writeText(url)\n        }}\n      >\n        Kopiera\n      </Button>\n    </div>\n  </>\n)\n\nexport default CalendarLink\n","import React, { useState } from 'react'\nimport useSWR from 'swr'\nimport { FiLink, FiTrash2 } from 'react-icons/fi'\nimport { List, ListItem, ListButton } from '../ui/list'\nimport useConfirmModal from '../modal/useConfirmModal'\nimport { del, post } from '../request'\nimport AddCalendarSubscription from './addCalendarSubscription'\nimport useModal, { useCloseModal } from '../modal/useModal'\nimport { Button } from '../ui/buttons'\nimport CalendarLink from './calendarLink'\n\nconst getTitle = sub => {\n  const parts = []\n  if (sub.include_bookings) parts.push('bokningar')\n  if (sub.include_events_attending) parts.push('anmälda evenemang')\n  if (sub.include_events_not_attending) parts.push('oanmälda evenemang')\n\n  const combined = parts.join(', ')\n  return combined.charAt(0).toUpperCase() + combined.substring(1)\n}\n\nconst CalendarSubscriptions = () => {\n  const [openCreateModal] = useModal(AddCalendarSubscription)\n  const [openLinkModal] = useModal(CalendarLink)\n  const [openConfirmation] = useConfirmModal()\n  const closeModal = useCloseModal()\n  const { data: subs, mutate } = useSWR('/account/calendar-subscriptions/')\n\n  return (\n    <div>\n      <h2>Kalenderprenumerationer</h2>\n      <List>\n        {subs &&\n          subs.map(sub => (\n            <ListItem\n              title={getTitle(sub)}\n              key={sub.id}\n              buttons={[\n                <ListButton\n                  iconComponent={FiLink}\n                  text=\"Visa länk\"\n                  onClick={() => {\n                    openLinkModal('Prenumerationslänk', {\n                      url: sub.url,\n                    })\n                  }}\n                  key=\"view\"\n                />,\n                <ListButton\n                  iconComponent={FiTrash2}\n                  text=\"Ta bort prenumeration\"\n                  onClick={() => {\n                    openConfirmation(\n                      'Är du säker på att du vill ta bort prenumerationen?',\n                      async () => {\n                        await del(`/account/calendar-subscriptions/${sub.id}/`)\n                        mutate(subs.filter(s => s.id !== sub.id))\n                      }\n                    )\n                  }}\n                  key=\"delete\"\n                />,\n              ]}\n            />\n          ))}\n      </List>\n      <Button\n        onClick={() => {\n          openCreateModal('Ny prenumeration', {\n            create: async data => {\n              const { data: newSub } = await post(\n                '/account/calendar-subscriptions/',\n                data\n              )\n              mutate([...subs, newSub])\n              closeModal()\n            },\n          })\n        }}\n      >\n        Ny prenumeration\n      </Button>\n    </div>\n  )\n}\n\nexport default CalendarSubscriptions\n","import React, { useContext } from 'react'\nimport { UserContext, LoadingContext } from '../layout/layout'\nimport Preferences from './preferences'\nimport BigPixels from '../layout/bigPixels'\nimport { GridContainer, GridItem } from '../ui/grid'\nimport CalendarSubscriptions from './calendarSubscriptions'\nimport TitleChooser from '../ui/titleChooser'\n\nconst PreferencesPage = ({ pageContext: { title } }) => {\n  const setLoading = useContext(LoadingContext)[1]\n  const [user, setUser] = useContext(UserContext)\n  return (\n    <BigPixels>\n      <GridContainer>\n        <GridItem fullWidth>\n          <TitleChooser title={title} />\n        </GridItem>\n        <GridItem>\n          <Preferences user={user} setUser={setUser} setLoading={setLoading} />\n        </GridItem>\n        <GridItem>\n          <CalendarSubscriptions />\n        </GridItem>\n      </GridContainer>\n    </BigPixels>\n  )\n}\n\nexport default PreferencesPage\n"],"names":["Label","inputWrapper","_ref","value","onChange","type","label","required","min_value","max_value","min_length","max_length","change","e","target","map","datetime","React","DateTimePicker","date","boolean","checked","integer","max","min","component","Object","prototype","hasOwnProperty","call","maxLength","minLength","className","Required","AutoForm","endpoint","method","customFetcher","onSubmit","defaults","fields","setFields","useState","values","setValues","errors","setErrors","useEffect","options","then","res","raw","data","actions","POST","editable","keys","key","filter","f","read_only","catch","err","preventDefault","response","request","field","AutoInput","assign","newValue","setValue","old","join","Button","onClick","defaultProps","Confirmation","text","onAccept","onDecline","close","useCloseModal","confirmation","useConfirmModal","openModal","isOpen","useModal","open","Error","inputLabel","_Component","Preferences","props","_this","user","profile","state","infomailSubscriber","infomail_subscriber","liuCardId","liu_card_id","firstName","first_name","lastName","last_name","handleChange","bind","_assertThisInitialized","handleSubmit","_inheritsLoose","_proto","event","checkbox","this","setState","setLoading","setUser","error","undefined","success","put","status","prev","console","log","getFormErrorText","_response$data","render","membership","Component","create","include_bookings","include_events_attending","include_events_not_attending","url","readOnly","navigator","clipboard","writeText","getTitle","sub","parts","push","combined","charAt","toUpperCase","substring","CalendarSubscriptions","openCreateModal","AddCalendarSubscription","openLinkModal","CalendarLink","openConfirmation","closeModal","subs","mutate","useSWR","List","ListItem","title","id","buttons","ListButton","iconComponent","FiLink","FiTrash2","async","del","s","newSub","post","concat","_toConsumableArray","pageContext","useContext","LoadingContext","UserContext","BigPixels","GridContainer","GridItem","fullWidth","TitleChooser"],"sourceRoot":""}