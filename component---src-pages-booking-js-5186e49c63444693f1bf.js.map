{"version":3,"sources":["webpack:///./src/components/booking/bookingInstance.js","webpack:///./src/components/booking/index.js","webpack:///./src/pages/booking.js","webpack:///./src/scss/booking.module.scss"],"names":["moment","locale","formatDate","date","toLocaleDateString","month","day","hour","minute","BookingInstance","props","_this","_Component","call","this","saveBooking","booking","_this$state","state","description","start","end","put","id","item_id","then","res","console","log","data","catch","err","response","open","editing","render","user","fullName","_this2","_this$props","showItem","_this$state2","react_default","a","createElement","className","style","bookingHeader","onClick","setState","prev","first_name","last_name","join","username","item","name","fromNow","fi","flip","undefined","Fragment","bookingBody","es","datePicker","selectsStart","selected","startDate","endDate","onChange","minDate","Date","maxDate","showTimeSelect","timeFormat","timeIntervals","dateFormat","timeCaption","selectsEnd","value","e","target","bookingButtons","Component","Booking","onlyMine","setLoading","root","request","endpoint","items","map","i","key","type","checked","bookings","b","Object","assign","sort","bookingInstance","BookingPage","layout","Consumer","loading","components_booking","set","module","exports"],"mappings":"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","file":"component---src-pages-booking-js-5186e49c63444693f1bf.js","sourcesContent":["import React, { Component } from 'react'\nimport DatePicker from 'react-datepicker'\nimport { FiChevronDown } from 'react-icons/fi'\nimport moment from 'moment'\nimport 'moment/locale/sv'\n\nimport 'react-datepicker/dist/react-datepicker.css'\nimport style from '../../scss/booking.module.scss'\nimport { put } from '../request/'\n\nmoment.locale('sv')\n\nconst getDisplayName = user => {\n  const fullName = [user.first_name, user.last_name].join(' ')\n  return fullName === ' ' ? user.username : fullName\n}\n\nconst formatDate = date =>\n  date.toLocaleDateString('sv-SE', {\n    month: 'short',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: 'numeric',\n  })\n\nclass BookingInstance extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      open: false,\n      editing: false,\n      description: props.booking.description,\n      start: props.booking.start,\n      end: props.booking.end,\n    }\n  }\n\n  saveBooking = () => {\n    const { booking } = this.props\n    const { description, start, end } = this.state\n    put(`/booking/bookings/${booking.id}/`, {\n      item_id: booking.item_id,\n      description,\n      start,\n      end,\n    })\n      .then(res => {\n        console.log(res.data)\n      })\n      .catch(err => {\n        console.log(err.response.data)\n      })\n  }\n\n  render() {\n    const { booking, showItem } = this.props\n    const { open, editing, description, start, end } = this.state\n\n    return (\n      <li>\n        <div\n          className={style.bookingHeader}\n          onClick={() => {\n            this.setState(prev => ({ open: !prev.open }))\n          }}\n        >\n          <strong>{getDisplayName(booking.user)}</strong>\n          {showItem && `, ${booking.item.name}`}\n          {`, ${moment(start).fromNow()}`}\n          <FiChevronDown className={open ? style.flip : undefined} />\n        </div>\n        {open && (\n          <>\n            <div className={style.bookingBody}>\n              <div>\n                {editing ? (\n                  <>\n                    <DatePicker\n                      className={style.datePicker}\n                      selectsStart\n                      selected={start}\n                      startDate={start}\n                      endDate={end}\n                      onChange={date => {\n                        this.setState({ start: date })\n                      }}\n                      minDate={new Date()}\n                      maxDate={end}\n                      showTimeSelect\n                      timeFormat=\"HH:mm\"\n                      timeIntervals={15}\n                      dateFormat=\"MMMM d, yyyy h:mm aa\"\n                      timeCaption=\"time\"\n                    />\n                    <DatePicker\n                      className={style.datePicker}\n                      selectsEnd\n                      selected={end}\n                      startDate={start}\n                      endDate={end}\n                      onChange={date => {\n                        this.setState({ end: date })\n                      }}\n                      minDate={start}\n                      showTimeSelect\n                      timeFormat=\"HH:mm\"\n                      timeIntervals={15}\n                      dateFormat=\"MMMM d, yyyy h:mm aa\"\n                      timeCaption=\"time\"\n                    />\n                  </>\n                ) : (\n                  `${formatDate(start)} - ${formatDate(end)}`\n                )}\n              </div>\n              <p>\n                {editing ? (\n                  <textarea\n                    value={description}\n                    onChange={e => {\n                      this.setState({ description: e.target.value })\n                    }}\n                  />\n                ) : (\n                  description\n                )}\n              </p>\n            </div>\n            <div className={style.bookingButtons}>\n              {!editing && (\n                <button onClick={() => this.setState({ editing: true })}>\n                  Edit\n                </button>\n              )}\n              {!editing && <button>Delete</button>}\n              {editing && (\n                <button onClick={() => this.setState({ editing: false })}>\n                  Cancel\n                </button>\n              )}\n              {editing && <button onClick={this.saveBooking}>Save</button>}\n            </div>\n          </>\n        )}\n      </li>\n    )\n  }\n}\n\nexport default BookingInstance\n","import React, { Component } from 'react'\nimport { Get } from '../request/'\n\nimport style from '../../scss/booking.module.scss'\nimport BookingInstance from './bookingInstance'\n\nconst getDisplayName = user => {\n  const fullName = [user.first_name, user.last_name].join(' ')\n  return fullName === ' ' ? user.username : fullName\n}\n\nconst formatDate = date =>\n  date.toLocaleDateString('sv-SE', {\n    month: 'short',\n    day: 'numeric',\n    hour: 'numeric',\n    minute: 'numeric',\n  })\n\nclass Booking extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      item: '',\n      onlyMine: false,\n    }\n  }\n  render() {\n    const { setLoading } = this.props\n    const { item, onlyMine } = this.state\n\n    return (\n      <div className={style.root}>\n        <Get endpoint=\"/booking/items/\">\n          {items => (\n            <>\n              <select\n                className={style.items}\n                onChange={e => {\n                  this.setState({ item: e.target.value })\n                }}\n                value={item}\n              >\n                <option value=\"\">Alla</option>\n                {items.map(i => (\n                  <option key={i.id} value={i.id}>\n                    {i.name}\n                  </option>\n                ))}\n              </select>\n            </>\n          )}\n        </Get>\n        <p>\n          <label>\n            <input\n              type=\"checkbox\"\n              onClick={e => {\n                this.setState({ onlyMine: e.target.checked })\n              }}\n              value={onlyMine}\n            />{' '}\n            Visa endast mina bokningar.\n          </label>\n        </p>\n        <Get\n          endpoint={`/booking/bookings/?item=${item}&future${\n            onlyMine ? '&user=me' : ''\n          }`}\n        >\n          {bookings => (\n            <ul className={style.bookings}>\n              {bookings\n                .map(b => ({\n                  ...b,\n                  start: new Date(b.start),\n                  end: new Date(b.end),\n                }))\n                .sort((a, b) => a.start - b.start)\n                .map(booking => (\n                  <BookingInstance\n                    booking={booking}\n                    showItem={item === ''}\n                    key={booking.id}\n                  />\n                ))}\n            </ul>\n          )}\n        </Get>\n      </div>\n    )\n  }\n}\n\nexport default Booking\n","import React from 'react'\nimport { LoadingContext } from '../components/layout'\nimport Booking from '../components/booking/'\n\nconst BookingPage = () => (\n  <LoadingContext.Consumer>\n    {loading => <Booking setLoading={loading.set} />}\n  </LoadingContext.Consumer>\n)\n\nexport default BookingPage\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"booking-module--root--bCHNE\",\"items\":\"booking-module--items--2uisw\",\"bookings\":\"booking-module--bookings--3tgRr\",\"bookingHeader\":\"booking-module--bookingHeader--2LkuV\",\"flip\":\"booking-module--flip--2eakz\",\"bookingBody\":\"booking-module--bookingBody--3_ixT\",\"datePicker\":\"booking-module--datePicker--l8p8O\",\"bookingButtons\":\"booking-module--bookingButtons--3jWVv\"};"],"sourceRoot":""}