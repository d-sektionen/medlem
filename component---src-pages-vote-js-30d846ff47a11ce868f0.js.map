{"version":3,"sources":["webpack:///./src/components/vote/voteForm.js","webpack:///./src/components/vote/activeVote.js","webpack:///./src/components/vote/index.js","webpack:///./src/pages/vote.js"],"names":["VoteForm","props","_this","_Component","call","this","state","checkedId","onMessage","onAlternativeChecked","bind","assertThisInitialized_default","placeVote","showMessage","alternativeId","setState","_this$props","setLoading","vote","voteData","vote_id","id","alternative_id","post","then","catch","error","render","_this2","votingDisabled","buttonText","react_default","a","createElement","question","alternatives","map","_ref","text","key","type","checked","onChange","disabled","onClick","Component","ActiveVote","votes","length","shownVote","has_voted","voteForm","Vote","message","displayReloadCloseText","closeMessage","onRequestFailed","title","content","Fragment","request","endpoint","onError","activeVote","VotePage","layout","Consumer","loading","components_content","components_vote","set"],"mappings":"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","file":"component---src-pages-vote-js-30d846ff47a11ce868f0.js","sourcesContent":["import React, { Component } from 'react'\nimport { post } from '../request'\n\nclass VoteForm extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      checkedId: -1,\n    }\n\n    const { onMessage } = this.props\n\n    this.onAlternativeChecked = this.onAlternativeChecked.bind(this)\n    this.placeVote = this.placeVote.bind(this)\n    this.showMessage = onMessage\n  }\n\n  onAlternativeChecked(alternativeId) {\n    this.setState({\n      checkedId: alternativeId,\n    })\n  }\n\n  placeVote() {\n    const { setLoading, vote } = this.props\n    const { checkedId } = this.state\n\n    const { showMessage } = this\n    const voteData = {\n      vote_id: vote.id,\n      alternative_id: checkedId,\n    }\n\n    setLoading(true)\n    post('/voting/made_votes/', voteData)\n      .then(() => {\n        setLoading(false)\n        showMessage('Tack!', 'Din röst har registrerats')\n      })\n      .catch(error => {\n        setLoading(false)\n        showMessage('Ett fel uppstod', error)\n      })\n  }\n\n  render() {\n    const { vote } = this.props\n    const { checkedId } = this.state\n\n    const votingDisabled = checkedId === -1\n    const buttonText = votingDisabled ? 'Välj ett alternativ' : 'Rösta'\n\n    return (\n      <div>\n        <strong>{vote.question}</strong>\n        <ul>\n          {vote.alternatives.map(({ text, id }) => (\n            <li key={id}>\n              <label>\n                <input\n                  type=\"radio\"\n                  checked={checkedId === id}\n                  onChange={() => this.onAlternativeChecked(id)}\n                />\n                {` ${text}`}\n              </label>\n            </li>\n          ))}\n        </ul>\n        <button\n          type=\"button\"\n          disabled={votingDisabled}\n          onClick={this.placeVote}\n        >\n          {buttonText}\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default VoteForm\n","import React from 'react'\nimport VoteForm from './voteForm'\n\nconst ActiveVote = ({ votes, onMessage, setLoading }) => {\n  if (votes.length === 0) return <div>Det finns ingen aktiv omröstning</div>\n\n  const shownVote = votes[0]\n\n  return shownVote.has_voted ? (\n    <p>Du har redan röstat i den nuvarande omröstningen.</p>\n  ) : (\n    <VoteForm vote={shownVote} onMessage={onMessage} setLoading={setLoading} />\n  )\n}\n\nexport default ActiveVote\n","import React, { Component } from 'react'\nimport ActiveVote from './activeVote'\nimport { Get } from '../request'\n\n// import style from '../../scss/vote.module.scss'\n\n// TODO: prettify this file\n\nclass Vote extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      message: null,\n      displayReloadCloseText: false,\n    }\n\n    this.showMessage = this.showMessage.bind(this)\n    this.closeMessage = this.closeMessage.bind(this)\n    this.onRequestFailed = this.onRequestFailed.bind(this)\n  }\n\n  onRequestFailed() {\n    this.showMessage(\n      'Något gick fel',\n      'Logga ut eller refresha eller nåt.',\n      true\n    )\n  }\n\n  closeMessage() {\n    this.setState({ message: null })\n  }\n\n  showMessage(title, content, displayReloadCloseText) {\n    this.setState({\n      displayReloadCloseText,\n      message: {\n        title,\n        content,\n      },\n    })\n  }\n\n  render() {\n    const { setLoading } = this.props\n    const { message } = this.state\n\n    if (message !== null) {\n      const { displayReloadCloseText } = this.state\n      const { title, content } = message\n      return (\n        <>\n          <h3>{title}</h3>\n          <p>{content}</p>\n          <button type=\"button\" onClick={this.closeMessage}>\n            {displayReloadCloseText ? 'Ladda om sidan' : 'Stäng'}\n          </button>\n        </>\n      )\n    }\n\n    return (\n      <Get\n        endpoint=\"/voting/votes/?current=true\"\n        onError={this.onRequestFailed}\n      >\n        {votes => (\n          <>\n            <h1>D-cide</h1>\n            <ActiveVote\n              votes={votes}\n              onMessage={this.showMessage}\n              setLoading={setLoading}\n            />\n          </>\n        )}\n      </Get>\n    )\n  }\n}\n\nexport default Vote\n","import React from 'react'\nimport { LoadingContext } from '../components/layout'\nimport Vote from '../components/vote'\nimport Content from '../components/content'\n\nconst VotePage = () => (\n  <LoadingContext.Consumer>\n    {loading => (\n      <Content>\n        <Vote setLoading={loading.set} />\n      </Content>\n    )}\n  </LoadingContext.Consumer>\n)\n\nexport default VotePage\n"],"sourceRoot":""}