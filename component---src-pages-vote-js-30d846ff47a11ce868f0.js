(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{196:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(19),r=n(7),l=n.n(r),i=n(2),c=n.n(i),u=n(59),d=function(e){function t(t){var n;(n=e.call(this,t)||this).state={checkedId:-1};var a=n.props.onMessage;return n.onAlternativeChecked=n.onAlternativeChecked.bind(l()(n)),n.placeVote=n.placeVote.bind(l()(n)),n.showMessage=a,n}c()(t,e);var n=t.prototype;return n.onAlternativeChecked=function(e){this.setState({checkedId:e})},n.placeVote=function(){var e=this.props,t=e.setLoading,n=e.vote,a=this.state.checkedId,s=this.showMessage,o={vote_id:n.id,alternative_id:a};t(!0),Object(u.e)("/voting/made_votes/",o).then(function(){t(!1),s("Tack!","Din röst har registrerats")}).catch(function(e){t(!1),s("Ett fel uppstod",e)})},n.render=function(){var e=this,t=this.props.vote,n=this.state.checkedId,a=-1===n,o=a?"Välj ett alternativ":"Rösta";return s.a.createElement("div",null,s.a.createElement("strong",null,t.question),s.a.createElement("ul",null,t.alternatives.map(function(t){var a=t.text,o=t.id;return s.a.createElement("li",{key:o},s.a.createElement("label",null,s.a.createElement("input",{type:"radio",checked:n===o,onChange:function(){return e.onAlternativeChecked(o)}})," "+a))})),s.a.createElement("button",{type:"button",disabled:a,onClick:this.placeVote},o))},t}(a.Component),h=function(e){var t=e.votes,n=e.onMessage,a=e.setLoading;if(0===t.length)return s.a.createElement("div",null,"Det finns ingen aktiv omröstning");var o=t[0];return o.has_voted?s.a.createElement("p",null,"Du har redan röstat i den nuvarande omröstningen."):s.a.createElement(d,{vote:o,onMessage:n,setLoading:a})},g=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={message:null,displayReloadCloseText:!1},n.showMessage=n.showMessage.bind(l()(n)),n.closeMessage=n.closeMessage.bind(l()(n)),n.onRequestFailed=n.onRequestFailed.bind(l()(n)),n}c()(t,e);var n=t.prototype;return n.onRequestFailed=function(){this.showMessage("Något gick fel","Logga ut eller refresha eller nåt.",!0)},n.closeMessage=function(){this.setState({message:null})},n.showMessage=function(e,t,n){this.setState({displayReloadCloseText:n,message:{title:e,content:t}})},n.render=function(){var e=this,t=this.props.setLoading,n=this.state.message;if(null!==n){var a=this.state.displayReloadCloseText,o=n.title,r=n.content;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h3",null,o),s.a.createElement("p",null,r),s.a.createElement("button",{type:"button",onClick:this.closeMessage},a?"Ladda om sidan":"Stäng"))}return s.a.createElement(u.a,{endpoint:"/voting/votes/?current=true",onError:this.onRequestFailed},function(n){return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",null,"D-cide"),s.a.createElement(h,{votes:n,onMessage:e.showMessage,setLoading:t}))})},t}(a.Component),p=n(42);t.default=function(){return s.a.createElement(o.a.Consumer,null,function(e){return s.a.createElement(p.a,null,s.a.createElement(g,{setLoading:e.set}))})}}}]);
//# sourceMappingURL=component---src-pages-vote-js-30d846ff47a11ce868f0.js.map