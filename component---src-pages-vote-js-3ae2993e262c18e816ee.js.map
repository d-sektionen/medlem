{"version":3,"sources":["webpack:///./src/components/vote/voteForm.js","webpack:///./src/components/vote/activeVote.js","webpack:///./src/components/vote/index.js","webpack:///./src/pages/vote.js"],"names":["VoteForm","props","_this","_Component","call","this","state","checkedId","onAlternativeChecked","bind","assertThisInitialized_default","placeVote","showMessage","onMessage","alternativeId","setState","_this$props","setLoading","vote","voteData","vote_id","id","alternative_id","post","then","res","catch","error","render","_this2","votingDisabled","buttonText","react_default","a","createElement","question","alternatives","map","_ref","text","key","type","checked","onChange","disabled","onClick","Component","ActiveVote","votes","length","shownVote","has_voted","voteForm","Vote","message","displayReloadCloseText","closeMessage","onRequestFailed","title","content","_this$state","Fragment","request","endpoint","onError","activeVote","PreferencesPage","layout","Consumer","loading","components_vote","set"],"mappings":"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","file":"component---src-pages-vote-js-3ae2993e262c18e816ee.js","sourcesContent":["import React, { Component } from 'react'\nimport { post } from '../request/'\n\nclass VoteForm extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      checkedId: -1,\n    }\n\n    this.onAlternativeChecked = this.onAlternativeChecked.bind(this)\n    this.placeVote = this.placeVote.bind(this)\n    this.showMessage = this.props.onMessage\n  }\n\n  onAlternativeChecked(alternativeId) {\n    this.setState({\n      checkedId: alternativeId,\n    })\n  }\n\n  placeVote() {\n    const { setLoading, vote } = this.props\n\n    const showMessage = this.showMessage\n    const voteData = {\n      vote_id: vote.id,\n      alternative_id: this.state.checkedId,\n    }\n\n    setLoading(true)\n    post('/voting/made_votes/', voteData)\n      .then(res => {\n        setLoading(false)\n        showMessage('Tack!', 'Din röst har registrerats')\n      })\n      .catch(error => {\n        setLoading(false)\n        showMessage('Ett fel uppstod', error)\n      })\n  }\n\n  render() {\n    const { vote } = this.props\n    const { checkedId } = this.state\n\n    const votingDisabled = checkedId === -1\n    const buttonText = votingDisabled ? 'Välj ett alternativ' : 'Rösta'\n\n    return (\n      <div>\n        <strong>{vote.question}</strong>\n        <ul>\n          {vote.alternatives.map(({ text, id }) => (\n            <li key={id}>\n              <label>\n                <input\n                  type=\"radio\"\n                  checked={checkedId === id}\n                  onChange={() => this.onAlternativeChecked(id)}\n                />{' '}\n                {text}\n              </label>\n            </li>\n          ))}\n        </ul>\n        <button\n          type=\"button\"\n          disabled={votingDisabled}\n          onClick={this.placeVote}\n        >\n          {buttonText}\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default VoteForm\n","import React from 'react'\nimport VoteForm from './voteForm'\n\nconst ActiveVote = ({ votes, onMessage, setLoading }) => {\n  if (votes.length === 0) return <div>Det finns ingen aktiv omröstning</div>\n\n  const shownVote = votes[0]\n\n  return shownVote.has_voted ? (\n    <p>Du har redan röstat i den nuvarande omröstningen.</p>\n  ) : (\n    <VoteForm vote={shownVote} onMessage={onMessage} setLoading={setLoading} />\n  )\n}\n\nexport default ActiveVote\n","import React, { Component } from 'react'\nimport ActiveVote from './activeVote'\nimport { Get } from '../request/'\n\n// import style from '../../scss/vote.module.scss'\n\nclass Vote extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      message: null,\n      displayReloadCloseText: false,\n    }\n\n    this.showMessage = this.showMessage.bind(this)\n    this.closeMessage = this.closeMessage.bind(this)\n    this.onRequestFailed = this.onRequestFailed.bind(this)\n  }\n\n  showMessage(title, content, displayReloadCloseText) {\n    this.setState({\n      displayReloadCloseText: displayReloadCloseText,\n      message: {\n        title: title,\n        content: content,\n      },\n    })\n  }\n\n  closeMessage() {\n    this.setState({ message: null })\n  }\n\n  onRequestFailed() {\n    this.showMessage(\n      'Något gick fel',\n      'Logga ut eller refresha eller nåt.',\n      true\n    )\n  }\n\n  render() {\n    const { setLoading } = this.props\n\n    if (this.state.message !== null) {\n      const { displayReloadCloseText, message } = this.state\n      const { title, content } = message\n      return (\n        <>\n          <h3>{title}</h3>\n          <p>{content}</p>\n          <button type=\"button\" onClick={this.closeMessage}>\n            {displayReloadCloseText ? 'Ladda om sidan' : 'Stäng'}\n          </button>\n        </>\n      )\n    }\n\n    return (\n      <Get\n        endpoint=\"/voting/votes/?current=true\"\n        onError={this.onRequestFailed}\n      >\n        {votes => (\n          <>\n            <h1>D-cide</h1>\n            <ActiveVote\n              votes={votes}\n              onMessage={this.showMessage}\n              setLoading={setLoading}\n            />\n          </>\n        )}\n      </Get>\n    )\n  }\n}\n\nexport default Vote\n","import React from 'react'\nimport { LoadingContext } from '../components/layout'\nimport Vote from '../components/vote/'\n\nconst PreferencesPage = () => (\n  <LoadingContext.Consumer>\n    {loading => <Vote setLoading={loading.set} />}\n  </LoadingContext.Consumer>\n)\n\nexport default PreferencesPage\n"],"sourceRoot":""}