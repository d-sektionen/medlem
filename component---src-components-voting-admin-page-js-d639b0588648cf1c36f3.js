(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"+1s0":function(e,t,n){"use strict";n.r(t);n("a1Th"),n("rGqo"),n("rE2o"),n("ioFf");var a=n("q1tI"),r=n.n(a),l=n("VtrM"),i=n("Rq/j"),c=n("ZACD");var o=({currentMeeting:e,updatePatch:t})=>r.a.createElement("div",null,r.a.createElement("h2",null,"Mötesinfo"),r.a.createElement("h3",null,e.name),e.description&&r.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.description),r.a.createElement("h3",null,"Detaljer"),r.a.createElement("ul",null,r.a.createElement("li",null,e.enable_speaker_requests?"Talarlista aktiverad":"Talarlista inaktiverad"),r.a.createElement("li",null,e.open_attendance?"Öppen incheckning":"Stängd incheckning"),r.a.createElement("li",null,"Mötesdata rensas: "+e.clear_data)),r.a.createElement(i.b,null,r.a.createElement(i.a,{onClick:()=>t({enable_speaker_requests:!e.enable_speaker_requests})},e.enable_speaker_requests?"Inaktivera talarlista":"Aktivera talarlista"),r.a.createElement(i.a,{onClick:()=>t({open_attendance:!e.open_attendance})},e.open_attendance?"Stäng självincheckning":"Öppna självincheckning"))),u=n("ReHE"),m=n("Tgqd"),s=n("zGz4");function d(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}let p=0;const f=(e={})=>(p+=1,Object.assign({text:""},e,{key:p}));var y=({currentMeeting:e,create:t,updateData:n,update:l})=>{const{0:i,1:c}=Object(a.useState)(n?n.question:""),{0:o,1:u}=Object(a.useState)(n?n.alternatives.map(e=>f(e)):[f(),f()]),{0:m,1:s}=Object(a.useState)(!n||n.open);return r.a.createElement("div",null,r.a.createElement("label",null,"Fråga",r.a.createElement("input",{value:i,onChange:e=>{c(e.target.value)}})),r.a.createElement("hr",null),r.a.createElement("ul",null,o.map((e,t)=>r.a.createElement("li",{key:e.key},r.a.createElement("input",{value:e.text,onChange:e=>{const n=e.target.value;u(e=>[].concat(d(e.slice(0,t)),[Object.assign({},e[t],{text:n})],d(e.slice(t+1))))}}),r.a.createElement("button",{type:"button",onClick:()=>{u(e=>[].concat(d(e.slice(0,t)),d(e.slice(t+1))))}},"X")))),r.a.createElement("button",{type:"button",onClick:()=>{u(e=>[].concat(d(e),[f()]))}},"Lägg till alternativ"),r.a.createElement("hr",null),r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:m,onChange:()=>s(e=>!e)}),"Nuvarande frågan"),r.a.createElement("hr",null),r.a.createElement("button",{type:"button",onClick:()=>{n?l(n.id,{question:i,open:m,alternatives:o,meeting:e.id}):t({question:i,open:m,alternatives:o,meeting:e.id})}},n?"Uppdatera omröstning":"Skapa ny omröstning"))};var g=({currentMeeting:e,voteId:t})=>{const{data:n}=Object(l.b)(()=>t&&"/voting/admin-votes/"+t+"/"),a=(n?n.alternatives.map(e=>e.num_votes):[]).reduce((e,t)=>e+t,0);return r.a.createElement("div",null,r.a.createElement("ul",null,n&&n.alternatives.map(e=>r.a.createElement("li",{key:e.text},e.text+": "+e.num_votes,a?" ("+(e.num_votes?Math.round(1e3*e.num_votes/a)/10:0)+"%)":""))),r.a.createElement("p",null,"Summa: ",a))},v=n("QaCa");function E(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var j=({currentMeeting:e})=>{const{data:t,mutate:n}=Object(l.b)("/voting/admin-votes/?event_id="+e.id),o=async e=>{const{data:a}=await Object(c.f)("/voting/admin-votes/",e);return n([].concat(E(t),[a])),a},u=async(e,a)=>{const{data:r}=await Object(c.g)("/voting/admin-votes/"+e+"/",a);return n([].concat(E(t.filter(t=>t.id!==e)),[r])),r},[d]=Object(s.a)(y),[b]=Object(s.a)(g),p=Object(s.b)();return Object(a.useEffect)(p,[t]),r.a.createElement("div",null,r.a.createElement("h2",null,"Omröstningar"),r.a.createElement(i.a,{onClick:()=>d("Ny omröstning",{currentMeeting:e,create:o})},"Ny omröstning"),r.a.createElement(v.a,null,t&&t.filter(t=>t.meeting===e.id).map(t=>r.a.createElement(v.c,{title:t.question,subtitle:t.open?"Active":void 0,key:t.id,buttons:[r.a.createElement(v.b,{onClick:()=>b('Resultat av "'+t.question+'"',{voteId:t.id}),iconComponent:m.a,text:"Resultat",key:"results"}),r.a.createElement(v.b,{onClick:()=>d('Uppdatera "'+t.question+'"',{currentMeeting:e,update:u,updateData:t}),iconComponent:m.d,text:"Uppdatera omröstning",key:"update"})]}))))};function k(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var S=({currentMeeting:e})=>{const{0:t,1:n}=Object(a.useState)(""),{data:o,mutate:u}=Object(l.b)(()=>"/voting/attendants/?meeting_id="+e.id,{refreshInterval:4e3});return null===o?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",null,r.a.createElement("h2",null,"Deltagare"),r.a.createElement("form",{onSubmit:async a=>{a.preventDefault(),n("");const{data:r}=await Object(c.f)("/voting/attendants/",{user_username:t,meeting_id:e.id});u([].concat(k(o),[r]))}},r.a.createElement("input",{value:t,onChange:e=>n(e.target.value)})),r.a.createElement("div",null,r.a.createElement(i.b,null,r.a.createElement("p",null,"Röstlängd: "+(o?o.length:0)),r.a.createElement(i.a,{onClick:async()=>{await Object(c.b)("/voting/attendants/clear/?meeting_id="+e.id),u([])}},"Återställ deltagarlista"))),r.a.createElement(v.a,null,o&&o.map(t=>r.a.createElement(v.c,{title:t.user.pretty_name,key:t.id,buttons:[r.a.createElement(v.b,{onClick:async()=>{await Object(c.b)("/voting/attendants/"+t.id,{meeting_id:e.id}),u(o.filter(e=>e.id!==t.id))},iconComponent:m.l,text:"Ta bort deltagare",key:"remove"})]}))))},C=n("zw+i");n("8k0H");var A=({meeting:e})=>{const{data:t,mutate:n}=Object(l.b)(()=>e&&"/voting/speakers/?meeting_id="+e.id,{refreshInterval:4e3});return r.a.createElement("div",null,r.a.createElement("h2",null,"Talarlista"),r.a.createElement(v.a,null,t&&t.map(e=>r.a.createElement(v.c,{title:e.user.pretty_name,subtitle:e.prioritized?"Replik":null,key:e.id,buttons:[r.a.createElement(v.b,{onClick:async()=>{await Object(c.b)("/voting/speakers/"+e.id),n(t.filter(t=>t.id!==e.id))},iconComponent:m.l,text:"Ta bort från talarlista",key:"remove"})]}))))},w=n("INns"),_=n("noUn");var q=({create:e})=>r.a.createElement(_.a,{endpoint:"/voting/admin-meetings/",customFetcher:e}),I=n("r90U");function M(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=({pageContext:{title:e}})=>{const{0:t,1:n}=Object(a.useState)(null),{data:i,mutate:m}=Object(l.b)("/voting/admin-meetings/"),[d]=Object(s.a)(q),b=Object(s.b)(),p=i?M(i).reverse():null;return Object(a.useEffect)(()=>{t&&n(p.find(e=>e.id===t.id))},[p]),r.a.createElement(I.a,null,r.a.createElement(C.a,null,r.a.createElement(C.b,{fullWidth:!0},r.a.createElement(w.a,{title:e,choice:t,setChoice:n,choices:p,label:"name",action:()=>{d("Nytt möte",{create:async e=>{await(async e=>{const{data:t}=await Object(c.f)("/voting/admin-meetings/",e);m([].concat(M(i),[t]))})(e),b()}})},actionLabel:"Nytt möte"})),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.b,null,r.a.createElement(o,{currentMeeting:t,updatePatch:async e=>{const{data:n}=await Object(c.e)("/voting/admin-meetings/"+t.id+"/",e);m([].concat(M(i.filter(e=>e.id!==t.id)),[n]))}})),r.a.createElement(C.b,null,r.a.createElement(j,{currentMeeting:t})),r.a.createElement(C.b,null,r.a.createElement(u.a,{event:t})),r.a.createElement(C.b,null,r.a.createElement(S,{currentMeeting:t})),r.a.createElement(C.b,null,r.a.createElement(A,{meeting:t})))))}},ReHE:function(e,t,n){"use strict";n("a1Th"),n("rGqo"),n("rE2o"),n("ioFf");var a=n("q1tI"),r=n.n(a),l=n("Tgqd"),i=n("QaCa"),c=n("VtrM"),o=n("ZACD");function u(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.a=({event:e})=>{const{0:t,1:n}=Object(a.useState)(""),{data:m,mutate:s}=Object(c.b)("/checkin/doorkeepers/?event_id="+e.id);return r.a.createElement("div",null,r.a.createElement("h2",null,"Dörrvakter"),r.a.createElement("form",{onSubmit:a=>{a.preventDefault(),n(""),(async e=>{const{data:t}=await Object(o.f)("/checkin/doorkeepers/",e);s([].concat(u(m),[t]))})({user_username:t,event_id:e.id})}},r.a.createElement("input",{value:t,onChange:e=>n(e.target.value)})),r.a.createElement(i.a,null,m&&m.map(e=>r.a.createElement(i.c,{title:e.user.pretty_name,key:e.id,buttons:[r.a.createElement(i.b,{onClick:()=>(async e=>{await Object(o.b)("/checkin/doorkeepers/"+e+"/"),s(m.filter(t=>t.id!==e))})(e.id),iconComponent:l.l,text:"Ta bort dörrvakt",key:"remove"})]}))))}},kRcL:function(e,t,n){e.exports={label:"form-module--label--1j4rO",inputWrapper:"form-module--inputWrapper--tEZjQ",required:"form-module--required--1ei65"}},noUn:function(e,t,n){"use strict";n("rGqo");var a=n("q1tI"),r=n.n(a),l=n("ZACD"),i=n("X0yR"),c=n("kRcL"),o=n.n(c);var u=({value:e,onChange:t,type:n,label:a,required:l,min_value:c,max_value:u,min_length:m,max_length:s})=>{const d=e=>{t(e.target.value)},b={datetime:r.a.createElement(i.a,{value:e,onChange:t}),date:r.a.createElement("input",{type:"date",value:e,onChange:d}),boolean:r.a.createElement("input",{type:"checkbox",value:e,onChange:e=>{t(e.target.checked)}}),integer:r.a.createElement("input",{type:"number",value:e,onChange:d,max:u,min:c})},p=Object.prototype.hasOwnProperty.call(b,n)?b[n]:r.a.createElement("input",{value:e,onChange:d,maxLength:s,minLength:m});return r.a.createElement("label",{className:o.a.label},""+a,l&&r.a.createElement("span",{className:o.a.required},"*"),r.a.createElement("div",{className:o.a.inputWrapper},p))},m=n("Rq/j");const s=({endpoint:e,method:t,customFetcher:n,onSubmit:i})=>{const{0:c,1:o}=Object(a.useState)(),{0:s,1:d}=Object(a.useState)({}),{0:b,1:p}=Object(a.useState)({});return Object(a.useEffect)(()=>{Object(l.d)(e).then(e=>{const t=e.data.actions.POST,n=Object.keys(t).map(e=>Object.assign({key:e},t[e])).filter(e=>!e.read_only);o(n)}).catch(e=>{})},e),r.a.createElement("form",{onSubmit:a=>{a.preventDefault(),i(),n?n(s).catch(e=>{e.response&&p(e.response.data)}):Object(l.a)({endpoint:e,method:t,data:s})}},c&&c.map(e=>r.a.createElement(r.a.Fragment,{key:e.key},r.a.createElement(u,Object.assign({},e,{onChange:t=>{((e,t)=>{d(n=>Object.assign({},n,{[e]:t}))})(e.key,t)},value:s[e.key]})),Object.prototype.hasOwnProperty.call(b,e.key)&&r.a.createElement("div",null,b[e.key].join(", ")))),r.a.createElement(m.a,{type:"submit",onClick:()=>{}},"Submit"))};s.defaultProps={method:"POST",customFetcher:null,onSubmit:()=>{}};t.a=s}}]);
//# sourceMappingURL=component---src-components-voting-admin-page-js-d639b0588648cf1c36f3.js.map