(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"sM+Y":function(e,a,t){e.exports={inputLabel:"preferences-module--inputLabel--37O6A",error:"preferences-module--error--2-qsf",success:"preferences-module--success--1uRT2"}},vwZb:function(e,a,t){"use strict";t.r(a);var r=t("q1tI"),s=t.n(r),n=t("8k0H"),l=t("ZACD"),i=t("sM+Y"),c=t.n(i),m=t("Rq/j");class u extends r.Component{constructor(e){super(e),e.user.profile||(e.user.profile={}),this.state={infomailSubscriber:e.user.profile.infomail_subscriber,liuCardId:e.user.profile.liu_card_id,firstName:e.user.first_name,lastName:e.user.last_name,errors:{}},this.handleChange=this.handleChange.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleChange(e,a,t=!1){t?this.setState({[e]:a.target.checked}):this.setState({[e]:a.target.value})}handleSubmit(e){const{setLoading:a,setUser:t}=this.props;this.setState({error:void 0,success:void 0,errors:{}}),a(!0),Object(l.e)("/account/user/me/",{first_name:this.state.firstName,last_name:this.state.lastName,profile:{liu_card_id:this.state.liuCardId,infomail_subscriber:this.state.infomailSubscriber}}).then(e=>{a(!1),e.status<300&&(this.setState({success:"Ändringarna har sparats."}),t(e.data))}).catch(e=>{console.log(e),a(!1),e.response?400===e.response.status?this.setState({errors:e.response.data}):this.setState({error:"Något gick fel."}):this.setState({error:"Nätverksfel."})}),e.preventDefault()}render(){const{user:e,title:a}=this.props,{firstName:t,lastName:r,liuCardId:n,infomailSubscriber:l,errors:i,error:u,success:o}=this.state;return s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("h1",null,a),s.a.createElement("p",null,s.a.createElement("strong",null,e.membership?"Du är sektionsmedlem.":"Du saknar sektionsmedlemsskap.")),s.a.createElement("div",null,s.a.createElement("label",{className:c.a.inputLabel},"Förnamn:",s.a.createElement("input",{value:t,onChange:e=>this.handleChange("firstName",e)})),i.first_name&&s.a.createElement("div",{className:c.a.error},i.first_name)),s.a.createElement("div",null,s.a.createElement("label",{className:c.a.inputLabel},"Efternamn:",s.a.createElement("input",{value:r,onChange:e=>this.handleChange("lastName",e)})),i.last_name&&s.a.createElement("div",{className:c.a.error},i.last_name)),s.a.createElement("div",null,s.a.createElement("label",{className:c.a.inputLabel},"LiU-kortnummer:",s.a.createElement("input",{value:n,onChange:e=>this.handleChange("liuCardId",e)})),i.profile&&i.profile.liu_card_id&&s.a.createElement("div",{className:c.a.error},i.profile.liu_card_id)),s.a.createElement("div",null,s.a.createElement("label",{className:c.a.inputLabel},"Prenumerera på veckomailet:",s.a.createElement("input",{type:"checkbox",checked:l,onChange:e=>this.handleChange("infomailSubscriber",e,!0)})),i.profile&&i.profile.infomail_subscriber&&s.a.createElement("div",{className:c.a.error},i.profile.infomail_subscriber)),s.a.createElement("div",null,s.a.createElement(m.a,{type:"submit"},"Spara")),s.a.createElement("div",null,u&&s.a.createElement("div",{className:c.a.error},u),o&&s.a.createElement("div",{className:c.a.success},o)))}}var o=u,d=t("r90U"),h=t("zw+i");a.default=({pageContext:{title:e}})=>{const a=Object(r.useContext)(n.a)[1],{0:t,1:l}=Object(r.useContext)(n.b);return s.a.createElement(d.a,null,s.a.createElement(h.a,null,s.a.createElement(h.b,null,s.a.createElement(o,{user:t,setUser:l,setLoading:a,title:e}))))}}}]);
//# sourceMappingURL=component---src-components-preferences-page-js-8ea56b7560d913f1031e.js.map