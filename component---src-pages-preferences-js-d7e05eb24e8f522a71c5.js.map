{"version":3,"sources":["webpack:///./src/components/preferences.js","webpack:///./src/pages/preferences.js","webpack:///./node_modules/core-js/modules/es6.function.name.js","webpack:///./src/scss/preferences.module.scss"],"names":["Preferences","props","_this","_Component","call","this","user","profile","state","liuCardId","liu_card_id","firstName","first_name","lastName","last_name","errors","handleChange","bind","assertThisInitialized_default","handleSubmit","field","event","_this$setState","setState","target","value","_this2","_this$props","setLoading","setUser","error","undefined","success","patch","then","res","status","data","catch","err","console","log","response","preventDefault","render","_this3","_this$state","react_default","a","createElement","onSubmit","sections","length","map","s","name","join","className","style","inputLabel","onChange","e","type","submit","Component","PreferencesPage","layout","Consumer","loading","_ref","set","content","preferences","dP","__webpack_require__","f","FProto","Function","prototype","nameRE","configurable","get","match","module","exports"],"mappings":"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","file":"component---src-pages-preferences-js-d7e05eb24e8f522a71c5.js","sourcesContent":["import React, { Component } from 'react'\n\nimport { put, patch } from './request/'\n\nimport style from '../scss/preferences.module.scss'\n\nclass Preferences extends Component {\n  constructor(props) {\n    super(props)\n\n    if (!props.user.profile) props.user.profile = {}\n\n    this.state = {\n      liuCardId: props.user.profile.liu_card_id,\n      firstName: props.user.first_name,\n      lastName: props.user.last_name,\n      errors: {},\n    }\n\n    this.handleChange = this.handleChange.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  handleChange(field, event) {\n    this.setState({ [field]: event.target.value })\n  }\n\n  handleSubmit(event) {\n    const { setLoading, setUser } = this.props\n\n    // reset errors\n    this.setState({ error: undefined, success: undefined, errors: {} })\n\n    setLoading(true)\n    patch('/account/user/me/', {\n      first_name: this.state.firstName,\n      last_name: this.state.lastName,\n      profile: {\n        liu_card_id: this.state.liuCardId,\n      },\n    })\n      .then(res => {\n        setLoading(false)\n        if (res.status < 300) {\n          this.setState({ success: 'Ändringarna har sparats.' })\n          setUser(res.data)\n        }\n      })\n      .catch(err => {\n        console.log(err)\n        setLoading(false)\n        if (!err.response) this.setState({ error: 'Nätverksfel.' })\n        else if (err.response.status === 400)\n          this.setState({ errors: err.response.data })\n        else this.setState({ error: 'Något gick fel.' })\n      })\n    event.preventDefault()\n  }\n\n  render() {\n    const { user } = this.props\n    const {\n      firstName,\n      lastName,\n      liuCardId,\n      errors,\n      error,\n      success,\n    } = this.state\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div>\n          {user.sections.length !== 0\n            ? `Du är medlem i ${user.sections.map(s => s.name).join(', ')}.`\n            : 'Du saknar sektionsmedlemsskap.'}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            Förnamn:\n            <input\n              value={firstName}\n              onChange={e => this.handleChange('firstName', e)}\n            />\n          </label>\n          {errors.first_name && (\n            <div className={style.error}>{errors.first_name}</div>\n          )}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            Efternamn:\n            <input\n              value={lastName}\n              onChange={e => this.handleChange('lastName', e)}\n            />\n          </label>\n          {errors.last_name && (\n            <div className={style.error}>{errors.last_name}</div>\n          )}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            LiU-kortnummer:\n            <input\n              value={liuCardId}\n              onChange={e => this.handleChange('liuCardId', e)}\n            />\n          </label>\n          {errors.profile && errors.profile.liu_card_id && (\n            <div className={style.error}>{errors.profile.liu_card_id}</div>\n          )}\n        </div>\n        <div>\n          <input\n            type=\"submit\"\n            value=\"Spara\"\n            className={`${style.submit} button`}\n          />\n        </div>\n        <div>\n          {error && <div className={style.error}>{error}</div>}\n          {success && <div className={style.success}>{success}</div>}\n        </div>\n      </form>\n    )\n  }\n}\n\nexport default Preferences\n","import React from 'react'\nimport { UserContext, LoadingContext } from '../components/layout'\nimport Preferences from '../components/preferences'\nimport Content from '../components/content'\n\nconst PreferencesPage = () => (\n  <LoadingContext.Consumer>\n    {loading => (\n      <UserContext.Consumer>\n        {({ user, set }) => (\n          <Content>\n            <Preferences user={user} setUser={set} setLoading={loading.set} />\n          </Content>\n        )}\n      </UserContext.Consumer>\n    )}\n  </LoadingContext.Consumer>\n)\n\nexport default PreferencesPage\n","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"inputLabel\":\"preferences-module--inputLabel--37O6A\",\"submit\":\"preferences-module--submit--2ALR0\",\"error\":\"preferences-module--error--2-qsf\",\"success\":\"preferences-module--success--1uRT2\"};"],"sourceRoot":""}