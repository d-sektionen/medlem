{"version":3,"sources":["webpack:///./src/components/preferences/preferences.js","webpack:///./src/components/preferences/page.js"],"names":["Preferences","props","_this","_Component","call","this","user","profile","state","infomailSubscriber","infomail_subscriber","liuCardId","liu_card_id","firstName","first_name","lastName","last_name","errors","handleChange","bind","assertThisInitialized_default","handleSubmit","field","event","checkbox","setState","[object Object]","target","checked","value","_this2","_this$props","setLoading","setUser","error","undefined","success","patch","then","res","status","data","catch","err","console","log","response","preventDefault","render","_this3","_this$state","react_default","a","createElement","onSubmit","membership","className","style","inputLabel","onChange","e","type","submit","Component","PreferencesPage","useContext","LoadingContext","_useContext","UserContext","bigPixels","grid","preferences"],"mappings":"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","file":"component---src-components-preferences-page-js-f9e27f664e2a11a2f66e.js","sourcesContent":["import React, { Component } from 'react'\n\nimport { put, patch } from '../request'\n\nimport style from '../../scss/preferences.module.scss'\n\nclass Preferences extends Component {\n  constructor(props) {\n    super(props)\n\n    if (!props.user.profile) props.user.profile = {}\n\n    this.state = {\n      infomailSubscriber: props.user.profile.infomail_subscriber,\n      liuCardId: props.user.profile.liu_card_id,\n      firstName: props.user.first_name,\n      lastName: props.user.last_name,\n      errors: {},\n    }\n\n    this.handleChange = this.handleChange.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  handleChange(field, event, checkbox = false) {\n    if (checkbox) this.setState({ [field]: event.target.checked })\n    else this.setState({ [field]: event.target.value })\n  }\n\n  handleSubmit(event) {\n    const { setLoading, setUser } = this.props\n\n    // reset errors\n    this.setState({ error: undefined, success: undefined, errors: {} })\n\n    setLoading(true)\n    patch('/account/user/me/', {\n      first_name: this.state.firstName,\n      last_name: this.state.lastName,\n      profile: {\n        liu_card_id: this.state.liuCardId,\n        infomail_subscriber: this.state.infomailSubscriber,\n      },\n    })\n      .then(res => {\n        setLoading(false)\n        if (res.status < 300) {\n          this.setState({ success: 'Ändringarna har sparats.' })\n          setUser(res.data)\n        }\n      })\n      .catch(err => {\n        console.log(err)\n        setLoading(false)\n        if (!err.response) this.setState({ error: 'Nätverksfel.' })\n        else if (err.response.status === 400)\n          this.setState({ errors: err.response.data })\n        else this.setState({ error: 'Något gick fel.' })\n      })\n    event.preventDefault()\n  }\n\n  render() {\n    const { user } = this.props\n    const {\n      firstName,\n      lastName,\n      liuCardId,\n      infomailSubscriber,\n      errors,\n      error,\n      success,\n    } = this.state\n    return (\n      <form onSubmit={this.handleSubmit}>\n        <div>\n          {user.membership\n            ? `Du är sektionsmedlem.`\n            : 'Du saknar sektionsmedlemsskap.'}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            Förnamn:\n            <input\n              value={firstName}\n              onChange={e => this.handleChange('firstName', e)}\n            />\n          </label>\n          {errors.first_name && (\n            <div className={style.error}>{errors.first_name}</div>\n          )}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            Efternamn:\n            <input\n              value={lastName}\n              onChange={e => this.handleChange('lastName', e)}\n            />\n          </label>\n          {errors.last_name && (\n            <div className={style.error}>{errors.last_name}</div>\n          )}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            LiU-kortnummer:\n            <input\n              value={liuCardId}\n              onChange={e => this.handleChange('liuCardId', e)}\n            />\n          </label>\n          {errors.profile && errors.profile.liu_card_id && (\n            <div className={style.error}>{errors.profile.liu_card_id}</div>\n          )}\n        </div>\n        <div>\n          <label className={style.inputLabel}>\n            Prenumerera på veckomailet:\n            <input\n              type=\"checkbox\"\n              checked={infomailSubscriber}\n              onChange={e => this.handleChange('infomailSubscriber', e, true)}\n            />\n          </label>\n          {errors.profile && errors.profile.infomail_subscriber && (\n            <div className={style.error}>\n              {errors.profile.infomail_subscriber}\n            </div>\n          )}\n        </div>\n        <div>\n          <input\n            type=\"submit\"\n            value=\"Spara\"\n            className={`${style.submit} button`}\n          />\n        </div>\n        <div>\n          {error && <div className={style.error}>{error}</div>}\n          {success && <div className={style.success}>{success}</div>}\n        </div>\n      </form>\n    )\n  }\n}\n\nexport default Preferences\n","import React, { useContext } from 'react'\nimport { UserContext, LoadingContext } from '../layout/layout'\nimport Preferences from './preferences'\nimport BigPixels from '../layout/bigPixels'\nimport { GridContainer, GridItem } from '../ui/grid'\n\nconst PreferencesPage = () => {\n  const setLoading = useContext(LoadingContext)[1]\n  const [user, setUser] = useContext(UserContext)\n  return (\n    <BigPixels>\n      <GridContainer>\n        <GridItem>\n          <Preferences user={user} setUser={setUser} setLoading={setLoading} />\n        </GridItem>\n      </GridContainer>\n    </BigPixels>\n  )\n}\n\nexport default PreferencesPage\n"],"sourceRoot":""}