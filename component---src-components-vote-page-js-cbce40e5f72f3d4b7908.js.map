{"version":3,"sources":["webpack:///./src/components/vote/voteForm.js","webpack:///./src/components/vote/activeVote.js","webpack:///./src/components/vote/index.js","webpack:///./src/components/vote/page.js"],"names":["VoteForm","Component","constructor","props","super","this","state","checkedId","onMessage","onAlternativeChecked","bind","placeVote","showMessage","alternativeId","setState","setLoading","vote","voteData","vote_id","id","alternative_id","post","then","catch","error","render","votingDisabled","buttonText","question","alternatives","map","text","key","type","checked","onChange","disabled","onClick","ActiveVote","votes","useEndpoint","endpoint","length","shownVote","has_voted","Vote","useContext","LoadingContext","message","setMessage","useState","displayReloadCloseText","setDisplayReloadCloseText","title","content","drct","VotePage"],"mappings":"sIAGA,MAAMA,UAAiBC,YACrBC,YAAYC,GACVC,MAAMD,GAENE,KAAKC,MAAQ,CACXC,WAAY,GAGd,MAAM,UAAEC,GAAcH,KAAKF,MAE3BE,KAAKI,qBAAuBJ,KAAKI,qBAAqBC,KAAKL,MAC3DA,KAAKM,UAAYN,KAAKM,UAAUD,KAAKL,MACrCA,KAAKO,YAAcJ,EAGrBC,qBAAqBI,GACnBR,KAAKS,SAAS,CACZP,UAAWM,IAIfF,YACE,MAAM,WAAEI,EAAF,KAAcC,GAASX,KAAKF,OAC5B,UAAEI,GAAcF,KAAKC,OAErB,YAAEM,GAAgBP,KAClBY,EAAW,CACfC,QAASF,EAAKG,GACdC,eAAgBb,GAGlBQ,GAAW,GACXM,YAAK,sBAAuBJ,GACzBK,KAAK,KACJP,GAAW,GACXH,EAAY,QAAS,+BAEtBW,MAAMC,IACLT,GAAW,GACXH,EAAY,kBAAmBY,KAIrCC,SACE,MAAM,KAAET,GAASX,KAAKF,OAChB,UAAEI,GAAcF,KAAKC,MAErBoB,GAAgC,IAAfnB,EACjBoB,EAAaD,EAAiB,sBAAwB,QAE5D,OACE,6BACE,gCAASV,EAAKY,UACd,4BACGZ,EAAKa,aAAaC,IAAI,EAAGC,OAAMZ,QAC9B,wBAAIa,IAAKb,GACP,+BACE,2BACEc,KAAK,QACLC,QAAS3B,IAAcY,EACvBgB,SAAU,IAAM9B,KAAKI,qBAAqBU,KAJ9C,IAMOY,MAKb,4BACEE,KAAK,SACLG,SAAUV,EACVW,QAAShC,KAAKM,WAEbgB,KAOI3B,QCpDAsC,MA1BI,EAAG1B,cAAaG,iBACjC,MAAOwB,EAAOf,GAASgB,YAAY,CACjCC,SAAU,gCAOZ,GAJIjB,GACFZ,EAAY,iBAAkB,sCAAsC,IAGjE2B,EAAO,OAAO,qCAEnB,GAAqB,IAAjBA,EAAMG,OAAc,OAAO,iEAE/B,MAAMC,EAAYJ,EAAM,GAExB,OAAOI,EAAUC,UACf,gFAEA,kBAAC,EAAD,CACE5B,KAAM2B,EACNnC,UAAWI,EACXG,WAAYA,KCeH8B,MAjCF,KACX,MAAM9B,EAAa+B,qBAAWC,KAAgB,IACvCC,EAASC,GAAcC,mBAAS,OAChCC,EAAwBC,GAA6BF,oBAAS,GAUrE,GAAgB,OAAZF,EAAkB,CACpB,MAAM,MAAEK,EAAF,QAASC,GAAYN,EAC3B,OACE,oCACE,4BAAKK,GACL,2BAAIC,GACJ,4BAAQrB,KAAK,SAASI,QAAS,IAAMY,EAAW,OAC7CE,EAAyB,iBAAmB,UAKrD,OACE,oCACE,sCACA,kBAAC,EAAD,CAAYvC,YAvBI,CAACyC,EAAOC,EAASC,KACnCH,EAA0BG,GAC1BN,EAAW,CACTI,QACAC,aAmBsCvC,WAAYA,M,gBClBzCyC,UAXE,IAEb,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,EAAD","file":"component---src-components-vote-page-js-cbce40e5f72f3d4b7908.js","sourcesContent":["import React, { Component } from 'react'\nimport { post } from '../request'\n\nclass VoteForm extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      checkedId: -1,\n    }\n\n    const { onMessage } = this.props\n\n    this.onAlternativeChecked = this.onAlternativeChecked.bind(this)\n    this.placeVote = this.placeVote.bind(this)\n    this.showMessage = onMessage\n  }\n\n  onAlternativeChecked(alternativeId) {\n    this.setState({\n      checkedId: alternativeId,\n    })\n  }\n\n  placeVote() {\n    const { setLoading, vote } = this.props\n    const { checkedId } = this.state\n\n    const { showMessage } = this\n    const voteData = {\n      vote_id: vote.id,\n      alternative_id: checkedId,\n    }\n\n    setLoading(true)\n    post('/voting/made_votes/', voteData)\n      .then(() => {\n        setLoading(false)\n        showMessage('Tack!', 'Din röst har registrerats')\n      })\n      .catch(error => {\n        setLoading(false)\n        showMessage('Ett fel uppstod', error)\n      })\n  }\n\n  render() {\n    const { vote } = this.props\n    const { checkedId } = this.state\n\n    const votingDisabled = checkedId === -1\n    const buttonText = votingDisabled ? 'Välj ett alternativ' : 'Rösta'\n\n    return (\n      <div>\n        <strong>{vote.question}</strong>\n        <ul>\n          {vote.alternatives.map(({ text, id }) => (\n            <li key={id}>\n              <label>\n                <input\n                  type=\"radio\"\n                  checked={checkedId === id}\n                  onChange={() => this.onAlternativeChecked(id)}\n                />\n                {` ${text}`}\n              </label>\n            </li>\n          ))}\n        </ul>\n        <button\n          type=\"button\"\n          disabled={votingDisabled}\n          onClick={this.placeVote}\n        >\n          {buttonText}\n        </button>\n      </div>\n    )\n  }\n}\n\nexport default VoteForm\n","import React from 'react'\nimport VoteForm from './voteForm'\nimport { useEndpoint } from '../request'\n\nconst ActiveVote = ({ showMessage, setLoading }) => {\n  const [votes, error] = useEndpoint({\n    endpoint: '/voting/votes/?current=true',\n  })\n\n  if (error) {\n    showMessage('Något gick fel', 'Logga ut eller refresha eller nåt.', true)\n  }\n\n  if (!votes) return <></>\n\n  if (votes.length === 0) return <div>Det finns ingen aktiv omröstning</div>\n\n  const shownVote = votes[0]\n\n  return shownVote.has_voted ? (\n    <p>Du har redan röstat i den nuvarande omröstningen.</p>\n  ) : (\n    <VoteForm\n      vote={shownVote}\n      onMessage={showMessage}\n      setLoading={setLoading}\n    />\n  )\n}\n\nexport default ActiveVote\n","import React, { useContext, useState } from 'react'\nimport ActiveVote from './activeVote'\nimport { Get, useEndpoint } from '../request'\nimport { LoadingContext } from '../layout/layout'\n\n// import style from '../../scss/vote.module.scss'\n\nconst Vote = () => {\n  const setLoading = useContext(LoadingContext)[1]\n  const [message, setMessage] = useState(null)\n  const [displayReloadCloseText, setDisplayReloadCloseText] = useState(false)\n\n  const showMessage = (title, content, drct) => {\n    setDisplayReloadCloseText(drct)\n    setMessage({\n      title,\n      content,\n    })\n  }\n\n  if (message !== null) {\n    const { title, content } = message\n    return (\n      <>\n        <h2>{title}</h2>\n        <p>{content}</p>\n        <button type=\"button\" onClick={() => setMessage(null)}>\n          {displayReloadCloseText ? 'Ladda om sidan' : 'Stäng'}\n        </button>\n      </>\n    )\n  }\n  return (\n    <>\n      <h1>D-cide</h1>\n      <ActiveVote showMessage={showMessage} setLoading={setLoading} />\n    </>\n  )\n}\n\nexport default Vote\n","import React, { useContext } from 'react'\nimport { LoadingContext } from '../layout/layout'\nimport Vote from '.'\nimport BigPixels from '../layout/bigPixels'\nimport { GridContainer, GridItem } from '../ui/grid'\n\nconst VotePage = () => {\n  return (\n    <BigPixels>\n      <GridContainer>\n        <GridItem>\n          <Vote />\n        </GridItem>\n      </GridContainer>\n    </BigPixels>\n  )\n}\nexport default VotePage\n"],"sourceRoot":""}