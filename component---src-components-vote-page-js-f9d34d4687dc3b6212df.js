"use strict";(self.webpackChunkmedlem=self.webpackChunkmedlem||[]).push([[464],{3541:function(e,t,n){n.d(t,{HC:function(){return i},aV:function(){return r},zj:function(){return c}});var l=n(7294),a=n(4608);const r=e=>{let{children:t}=e;return l.createElement("ul",{className:a.pb},t)},i=e=>{let{title:t,subtitle:n,buttons:r,color:i}=e;return l.createElement("li",{className:i?a.K:"",style:{borderColor:i}},l.createElement("div",{className:a.l_},l.createElement("h3",null,t),l.createElement("p",null,n)),l.createElement("div",{className:a.jk},r))};i.defaultProps={color:null};const c=e=>{let{href:t,onClick:n,iconComponent:r,text:i,shown:c}=e;return c?l.createElement(l.Fragment,null,t?l.createElement("a",{className:a.fq,href:t,onClick:n,title:i},l.createElement(r,null)):l.createElement("button",{className:a.fq,type:"button",onClick:n,title:i},l.createElement(r,null))):l.createElement(l.Fragment,null)};c.defaultProps={shown:!0}},7333:function(e,t,n){var l=n(5785),a=n(7294),r=n(4608),i=n(7580);const c=e=>{let{title:t,choices:n,categorizedChoices:c,choice:o,setChoice:s,label:m,action:u,actionLabel:d,noChoicesLabel:E,onChange:g}=e;const v=[].concat((0,l.Z)(n||[]),(0,l.Z)(Object.keys(c).reduce(((e,t)=>[].concat((0,l.Z)(e),(0,l.Z)(c[t]))),[])));return(0,a.useEffect)((()=>{const e=sessionStorage.getItem(t+"-selectedItem");if(!e)return;const n=v.find((t=>""+t.id===e));n&&s(n)}),[n,c]),a.createElement("div",{className:r.KW},a.createElement("h1",null,t),a.createElement("div",{className:r.Nw},v.length?a.createElement("div",{className:r.Nu},a.createElement("select",{onChange:e=>{const n=e.target.value,l=""===n?null:v.filter((e=>""+e.id===n))[0];s(l),g(e),l?sessionStorage.setItem(t+"-selectedItem",l.id):sessionStorage.removeItem(t+"-selectedItem")},value:o?o.id:""},a.createElement("option",{hidden:!0,value:""}),n.sort().map((e=>a.createElement("option",{value:e.id,key:e.id},e[m]))),Object.keys(c).sort().map((e=>a.createElement("optgroup",{label:e,key:e},c[e].sort().map((e=>a.createElement("option",{value:e.id,key:e.id},e[m]))))))),null===o&&a.createElement("div",{className:r.$f},"Välj ett objekt")):a.createElement("span",null,E),u&&a.createElement(i.zx,{onClick:u},d)))};c.defaultProps={categorizedChoices:{},choices:[],action:null,actionLabel:"",choice:null,noChoicesLabel:"",setChoice:()=>{},label:"",onChange:()=>{}},t.Z=c},7839:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var l=n(7294),a=n(2132),r=n(746),i=n(1288),c=n(7333),o=n(5785),s=n(2777),m=n(3541),u=n(7580),d=n(2525),E=n(8043);var g=e=>{let{meeting:t}=e;const{data:n,mutate:r}=(0,a.ZP)((()=>t&&"/voting/speakers/?meeting_id="+t.id)),{0:i}=(0,l.useContext)(d.St),c=t.attending?"Talarlista är inaktiverad för mötet.":"Du måste vara registrerad på mötet för att kunna skriva upp dig på talarlistan.";return l.createElement("div",null,l.createElement("h2",null,"Talarlista"),t.attending&&t.enable_speaker_requests?l.createElement(u.hE,null,l.createElement(u.zx,{onClick:async()=>{const{data:e}=await(0,E.v_)("/voting/speakers/",{meeting_id:t.id});r([].concat((0,o.Z)(n),[e]))}},"Jag vill tala!"),l.createElement(u.zx,{onClick:async()=>{const{data:e}=await(0,E.v_)("/voting/speakers/",{meeting_id:t.id,prioritized:!0});r([].concat((0,o.Z)(n),[e]))}},"Replik!")):l.createElement("p",null,c),l.createElement(m.aV,null,n&&n.map((e=>l.createElement(m.HC,{title:e.user.pretty_name,subtitle:e.prioritized?"Replik":null,key:e.id,buttons:[l.createElement(m.zj,{shown:i.id===e.user.id,onClick:async()=>{const l=e.prioritized?"&prioritized":"";await(0,E.IV)("/voting/speakers/?meeting_id="+t.id+l),r(n.filter((t=>t.id!==e.id)))},iconComponent:s.Ybf,text:"Lämna talarlista",key:"remove"})]})))))};var v=e=>{let{currentMeeting:t,revalidate:n}=e;return l.createElement("div",null,l.createElement("h2",null,"Mötesinfo"),l.createElement("h3",null,t.name),l.createElement("p",null,l.createElement("strong",null,t.attending?"Du deltar på mötet.":"Du är inte registrerad på mötet.")),t.description&&l.createElement("p",{style:{whiteSpace:"pre-line"}},t.description),t.open_attendance&&l.createElement("p",null,t.attending?l.createElement(u.zx,{onClick:async()=>{await(0,E.IV)("/voting/attend/?meeting_id="+t.id),n()}},"Lämna röstlängden"):l.createElement(u.zx,{onClick:async()=>{await(0,E.v_)("/voting/attend/",{meeting_id:t.id}),n()}},"Gå med i röstlängden")))};var p=e=>{let{vote:t,setErrors:n}=e;const{0:a,1:r}=(0,l.useState)(-1),{0:i,1:c}=(0,l.useState)(!1),{0:o,1:s}=(0,l.useState)(!1),m=-1===a,u=m?"Välj ett alternativ":"Rösta",d=i?"Tack för din röst!":"Du har röstat i omröstningen.";return l.createElement("div",null,l.createElement("strong",null,t.question),t.has_voted||i?l.createElement("p",null,d):l.createElement(l.Fragment,null,l.createElement("ul",null,t.alternatives.map((e=>{let{text:t,id:n}=e;return l.createElement("li",{key:n},l.createElement("label",null,l.createElement("input",{type:"radio",checked:a===n,onChange:()=>r(n)})," "+t))}))),l.createElement("button",{type:"button",disabled:m||i||o,onClick:async()=>{if(o||i)return;n({}),s(!0);const e={vote_id:t.id,alternative_id:a};await(0,E.v_)("/voting/made_votes/",e).then((()=>c(!0))).catch((e=>{s(!1),n({voteError:e.response.data.error})}))}},u)))};var h=e=>{let{meeting:t}=e;const{data:n}=(0,a.ZP)((()=>"/voting/votes/?meeting_id="+t.id)),{0:r,1:i}=(0,l.useState)({}),c=e=>{i(e),setTimeout((()=>i({})),3e3)};return l.createElement("div",null,l.createElement("h2",null,"Rösta"),r&&l.createElement("div",{className:"vote-module--formError--40ff7"},r.voteError),n&&l.createElement(l.Fragment,null,0===n.length&&l.createElement("p",null,"Det finns ingen aktiv omröstning"),n.map((e=>l.createElement(p,{key:e.id,vote:e,setErrors:c})))))};var f=e=>{let{pageContext:{title:t}}=e;const{0:n,1:o}=(0,l.useState)(null),{data:s,revalidate:m}=(0,a.ZP)("/voting/meetings/");return(0,l.useEffect)((()=>{n&&o(s.find((e=>e.id===n.id)))}),[s]),l.createElement(r.Z,null,l.createElement(i.T,null,l.createElement(i.P,{fullWidth:!0},l.createElement(c.Z,{title:t,choice:n,setChoice:o,choices:s,label:"name",noChoicesLabel:"Det finns inga möten just nu."})),n&&l.createElement(l.Fragment,null,l.createElement(i.P,null,l.createElement(v,{currentMeeting:n,revalidate:m})),l.createElement(i.P,null,l.createElement(g,{meeting:n})),l.createElement(i.P,null,l.createElement(h,{meeting:n})))))}}}]);
//# sourceMappingURL=component---src-components-vote-page-js-f9d34d4687dc3b6212df.js.map